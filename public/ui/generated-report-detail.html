<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>已生成报告详情 - LIMS-XW</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC',
          'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
        background: #f5f7fa;
        min-height: 100vh;
        margin: 0;
      }

      /* 主内容区 */
      .main-content {
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
      }

      /* 页面标题 */
      .page-header {
        margin-bottom: 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .page-title-section {
        flex: 1;
      }

      .page-title {
        font-size: 28px;
        color: #1f2937;
        font-weight: bold;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .report-number {
        color: #667eea;
      }

      .report-status {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
      }

      .report-status.generated {
        background: #d1fae5;
        color: #10b981;
      }

      .report-status.pending {
        background: #fef3c7;
        color: #f59e0b;
      }

      .urgent-badge {
        display: inline-block;
        padding: 4px 12px;
        background: #ef4444;
        color: white;
        border-radius: 20px;
        font-size: 14px;
        font-weight: bold;
      }

      .breadcrumb {
        color: #6b7280;
        font-size: 14px;
      }

      .breadcrumb a {
        color: #667eea;
        text-decoration: none;
      }

      .page-actions {
        display: flex;
        gap: 12px;
      }

      .btn {
        padding: 10px 20px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
      }

      .btn-success {
        background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
        color: white;
      }

      .btn-warning {
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        color: white;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      /* 内容布局 */
      .content-layout {
        display: grid;
        grid-template-columns: 1fr 380px;
        gap: 20px;
      }

      .main-info {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .info-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .card-header {
        font-size: 18px;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 20px;
        padding-bottom: 12px;
        border-bottom: 1px solid #e5e7eb;
      }

      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 16px;
      }

      .info-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .info-label {
        font-size: 12px;
        color: #6b7280;
      }

      .info-value {
        font-size: 14px;
        color: #1f2937;
        font-weight: 500;
      }

      /* 人员信息 */
      .staff-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
      }

      .staff-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: #f9fafb;
        border-radius: 8px;
      }

      .staff-avatar {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 16px;
        font-weight: bold;
      }

      .staff-info {
        flex: 1;
      }

      .staff-name {
        font-size: 14px;
        font-weight: 600;
        color: #1f2937;
      }

      .staff-role {
        font-size: 12px;
        color: #6b7280;
      }

      /* 报告预览 */
      .report-preview {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        text-align: center;
        padding: 60px 20px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s;
        position: relative;
        overflow: hidden;
      }

      .report-preview::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        opacity: 0;
        transition: opacity 0.3s;
      }

      .report-preview:hover::before {
        opacity: 1;
      }

      .report-preview:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
      }

      .preview-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 20px auto;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 36px;
      }

      .preview-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 8px;
      }

      .preview-desc {
        font-size: 14px;
        opacity: 0.9;
        margin-bottom: 16px;
      }

      .preview-info {
        font-size: 12px;
        opacity: 0.8;
      }

      /* 主要操作按钮 */
      .main-actions {
        display: flex;
        gap: 12px;
        margin-top: 20px;
      }

      .main-action-btn {
        flex: 1;
        padding: 16px;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      }

      .submit-btn {
        background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
        color: white;
      }

      .regenerate-btn {
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        color: white;
      }

      .main-action-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      /* 侧边栏 */
      .side-info {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .status-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .status-indicator {
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        margin-bottom: 16px;
      }

      .status-indicator.generated {
        background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
      }

      .status-indicator.pending {
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      }

      .status-text {
        color: white;
        font-size: 18px;
        font-weight: 600;
      }

      .status-details {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .status-detail-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .status-detail-label {
        font-size: 14px;
        color: #6b7280;
      }

      .status-detail-value {
        font-size: 14px;
        font-weight: 500;
        color: #1f2937;
      }

      /* 弹窗样式 */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
      }

      .modal-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        border-radius: 12px;
        padding: 24px;
        max-width: 500px;
        width: 90%;
      }

      .modal-header {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 16px;
      }

      .modal-body {
        margin-bottom: 20px;
      }

      .modal-footer {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
      }

      .btn-secondary {
        background: white;
        color: #6b7280;
        border: 1px solid #e5e7eb;
      }

      /* 报告预览弹窗 */
      .report-modal .modal-content {
        max-width: 90%;
        max-height: 90%;
        overflow-y: auto;
      }

      .report-document {
        padding: 40px;
        background: white;
        font-family: 'SimSun', serif;
        line-height: 1.6;
      }

      .document-title {
        text-align: center;
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 30px;
        color: #1f2937;
      }

      .document-section {
        margin-bottom: 24px;
      }

      .section-title {
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 12px;
        color: #1f2937;
      }

      .document-content {
        font-size: 14px;
        color: #374151;
      }

      /* 响应式设计 */
      @media (max-width: 768px) {
        .content-layout {
          grid-template-columns: 1fr;
        }

        .info-grid,
        .staff-grid {
          grid-template-columns: 1fr;
        }

        .main-actions {
          flex-direction: column;
        }

        .page-actions {
          flex-direction: column;
          gap: 8px;
        }

        .btn {
          width: 100%;
        }

        .modal-content {
          width: 95%;
          padding: 20px;
        }

        .report-document {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <script src="navigation.js"></script>

    <!-- 主内容 -->
    <div class="main-content">
      <!-- 页面头部 -->
      <div class="page-header">
        <div class="page-title-section">
          <h2 class="page-title">
            <span class="report-number">XW250903-100-RPT-001</span>
            <span class="report-status generated" id="report-status"
              >已生成</span
            >
            <span class="urgent-badge">加急</span>
          </h2>
          <div class="breadcrumb">
            <a href="report-dashboard.html">报告编制工作台</a> / 已生成报告详情
          </div>
        </div>
        <div class="page-actions" id="page-actions">
          <button class="btn btn-secondary" onclick="backToWorkspace()">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="currentColor"
              style="margin-right: 6px"
            >
              <path
                d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"
              />
            </svg>
            返回工作台
          </button>
          <button class="btn btn-primary">下载报告</button>
        </div>
      </div>

      <!-- 内容布局 -->
      <div class="content-layout">
        <!-- 左侧主信息区 -->
        <div class="main-info">
          <!-- 客户信息 -->
          <div class="info-card">
            <div class="card-header">客户信息</div>
            <div class="info-grid">
              <div class="info-item">
                <span class="info-label">客户名称</span>
                <span class="info-value">广州环保科技有限公司</span>
              </div>
              <div class="info-item">
                <span class="info-label">客户联系人</span>
                <span class="info-value">王经理</span>
              </div>
              <div class="info-item">
                <span class="info-label">客户联系电话</span>
                <span class="info-value">13800138001</span>
              </div>
              <div class="info-item">
                <span class="info-label">受检单位</span>
                <span class="info-value">广州环保科技总部</span>
              </div>
              <div class="info-item">
                <span class="info-label">受检单位地址</span>
                <span class="info-value">广州市天河区科技园A栋3楼</span>
              </div>
              <div class="info-item">
                <span class="info-label">检测类型</span>
                <span
                  class="info-value"
                  style="color: #059669; font-weight: 600"
                  >50325-2020</span
                >
              </div>
            </div>
          </div>

          <!-- 参与员工信息 -->
          <div class="info-card">
            <div class="card-header">参与员工信息</div>
            <div class="staff-grid">
              <div class="staff-item">
                <div class="staff-avatar">张</div>
                <div class="staff-info">
                  <div class="staff-name">张三</div>
                  <div class="staff-role">销售人员</div>
                </div>
              </div>
              <div class="staff-item">
                <div class="staff-avatar">赵</div>
                <div class="staff-info">
                  <div class="staff-name">赵六</div>
                  <div class="staff-role">采样人员</div>
                </div>
              </div>
              <div class="staff-item">
                <div class="staff-avatar">李</div>
                <div class="staff-info">
                  <div class="staff-name">李七</div>
                  <div class="staff-role">样品管理员</div>
                </div>
              </div>
              <div class="staff-item">
                <div class="staff-avatar">王</div>
                <div class="staff-info">
                  <div class="staff-name">王八</div>
                  <div class="staff-role">实验室管理员</div>
                </div>
              </div>
              <div class="staff-item">
                <div class="staff-avatar">孙</div>
                <div class="staff-info">
                  <div class="staff-name">孙九</div>
                  <div class="staff-role">检测人员</div>
                </div>
              </div>
              <div class="staff-item">
                <div class="staff-avatar">周</div>
                <div class="staff-info">
                  <div class="staff-name">周十</div>
                  <div class="staff-role">报告编制员</div>
                </div>
              </div>
            </div>
          </div>

          <!-- 报告预览 -->
          <div class="info-card">
            <div class="card-header">检测报告预览</div>
            <div class="report-preview" onclick="showReportPreview()">
              <div class="preview-icon">
                <svg
                  width="40"
                  height="40"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
                  />
                </svg>
              </div>
              <div class="preview-title">GB 50325-2020 检测报告</div>
              <div class="preview-desc">点击查看完整报告内容</div>
              <div class="preview-info">
                报告编号：XW250903-100-RPT-001<br />
                生成时间：2025-09-06 14:30<br />
                页数：8页 | 大小：2.5MB
              </div>
            </div>
          </div>

          <!-- 主要操作 -->
          <div class="main-actions" id="main-actions">
            <button
              class="main-action-btn submit-btn"
              onclick="submitForReview()"
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="currentColor"
                style="margin-right: 8px"
              >
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
              </svg>
              提交审核
            </button>
            <button
              class="main-action-btn regenerate-btn"
              onclick="regenerateReport()"
            >
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="currentColor"
                style="margin-right: 8px"
              >
                <path
                  d="M12,6V9L16,5L12,1V4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4Z"
                />
              </svg>
              重新生成
            </button>
          </div>
        </div>

        <!-- 右侧状态区 -->
        <div class="side-info">
          <!-- 报告状态 -->
          <div class="status-card">
            <div class="status-indicator generated" id="status-indicator">
              <div class="status-text" id="status-text">已生成</div>
            </div>
            <div class="status-details">
              <div class="status-detail-item">
                <span class="status-detail-label">报告类型</span>
                <span class="status-detail-value">50325-2020</span>
              </div>
              <div class="status-detail-item">
                <span class="status-detail-label">生成时间</span>
                <span class="status-detail-value">2025-09-06 14:30</span>
              </div>
              <div class="status-detail-item">
                <span class="status-detail-label">编制人员</span>
                <span class="status-detail-value">周十</span>
              </div>
              <div class="status-detail-item">
                <span class="status-detail-label">优先级</span>
                <span class="status-detail-value" style="color: #ef4444"
                  >加急</span
                >
              </div>
              <div class="status-detail-item">
                <span class="status-detail-label">预计交付</span>
                <span class="status-detail-value">2025-09-07</span>
              </div>
            </div>
          </div>

          <!-- 检测统计 -->
          <div class="status-card">
            <div class="card-header">检测统计</div>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
              "
            >
              <div
                style="
                  background: #f9fafb;
                  padding: 16px;
                  border-radius: 8px;
                  text-align: center;
                "
              >
                <div style="font-size: 24px; font-weight: bold; color: #667eea">
                  12
                </div>
                <div style="font-size: 12px; color: #6b7280">检测点位</div>
              </div>
              <div
                style="
                  background: #f9fafb;
                  padding: 16px;
                  border-radius: 8px;
                  text-align: center;
                "
              >
                <div style="font-size: 24px; font-weight: bold; color: #10b981">
                  59
                </div>
                <div style="font-size: 12px; color: #6b7280">检测合格项</div>
              </div>
              <div
                style="
                  background: #f9fafb;
                  padding: 16px;
                  border-radius: 8px;
                  text-align: center;
                "
              >
                <div style="font-size: 24px; font-weight: bold; color: #ef4444">
                  1
                </div>
                <div style="font-size: 12px; color: #6b7280">不合格项</div>
              </div>
              <div
                style="
                  background: #f9fafb;
                  padding: 16px;
                  border-radius: 8px;
                  text-align: center;
                "
              >
                <div style="font-size: 24px; font-weight: bold; color: #f59e0b">
                  98.3%
                </div>
                <div style="font-size: 12px; color: #6b7280">合格率</div>
              </div>
            </div>
          </div>

          <!-- 操作历史 -->
          <div class="status-card">
            <div class="card-header">操作历史</div>
            <div style="display: flex; flex-direction: column; gap: 12px">
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 12px;
                  padding: 12px;
                  background: #f9fafb;
                  border-radius: 6px;
                "
              >
                <div
                  style="
                    width: 8px;
                    height: 8px;
                    background: #10b981;
                    border-radius: 50%;
                  "
                ></div>
                <div style="flex: 1">
                  <div style="font-size: 13px; font-weight: 500">报告生成</div>
                  <div style="font-size: 11px; color: #6b7280">
                    2025-09-06 14:30 - 周十
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: 12px;
                  padding: 12px;
                  background: #fff3e0;
                  border-radius: 6px;
                "
              >
                <div
                  style="
                    width: 8px;
                    height: 8px;
                    background: #f59e0b;
                    border-radius: 50%;
                  "
                ></div>
                <div style="flex: 1">
                  <div style="font-size: 13px; font-weight: 500">
                    等待提交审核
                  </div>
                  <div style="font-size: 11px; color: #6b7280">当前状态</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 提交审核确认弹窗 -->
    <div id="submit-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">确认提交审核</div>
        <div class="modal-body">
          <p>
            确定要提交这份报告进行审核吗？提交后报告将发送给审核人员进行审查。
          </p>
          <p style="margin-top: 12px; color: #6b7280; font-size: 14px">
            报告编号：<span id="modal-report-number">XW250903-100-RPT-001</span>
          </p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="hideSubmitModal()">
            取消
          </button>
          <button class="btn btn-success" onclick="confirmSubmit()">
            确认提交
          </button>
        </div>
      </div>
    </div>

    <!-- 重新生成确认弹窗 -->
    <div id="regenerate-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">确认重新生成</div>
        <div class="modal-body">
          <p>
            确定要重新生成这份报告吗？此操作将返回到报告生成页面，您可以重新编辑和生成报告。
          </p>
          <p style="margin-top: 12px; color: #ef4444; font-size: 14px">
            注意：当前的报告内容将被覆盖。
          </p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="hideRegenerateModal()">
            取消
          </button>
          <button class="btn btn-warning" onclick="confirmRegenerate()">
            确认重新生成
          </button>
        </div>
      </div>
    </div>

    <!-- 报告预览弹窗 -->
    <div id="report-modal" class="report-modal modal">
      <div class="modal-content">
        <div class="modal-header">
          <span>检测报告预览</span>
          <button
            style="
              float: right;
              border: none;
              background: none;
              font-size: 18px;
              cursor: pointer;
            "
            onclick="hideReportModal()"
          >
            ×
          </button>
        </div>
        <div class="modal-body">
          <div class="report-document">
            <div class="document-title">GB 50325-2020 检测报告</div>

            <div class="document-section">
              <div class="section-title">一、基本信息</div>
              <div class="document-content">
                <p><strong>委托单位：</strong>广州环保科技有限公司</p>
                <p><strong>受检单位：</strong>广州环保科技总部</p>
                <p><strong>受检地址：</strong>广州市天河区科技园A栋3楼</p>
                <p><strong>检测类别：</strong>委托检测（采样）</p>
                <p><strong>检测范围：</strong>GB 50325-2020 检测</p>
                <p><strong>采样日期：</strong>2025年9月4日</p>
                <p><strong>检测日期：</strong>2025年9月5日至2025年9月6日</p>
              </div>
            </div>

            <div class="document-section">
              <div class="section-title">二、检测项目及依据</div>
              <div class="document-content">
                <p>
                  <strong>检测内容：</strong
                  >三苯五项：甲醛、苯、甲苯、二甲苯、TVOC
                </p>
                <p>
                  <strong>检测依据：</strong>GB
                  50325-2020《民用建筑工程室内环境污染控制标准》
                </p>
              </div>
            </div>

            <div class="document-section">
              <div class="section-title">三、主要检测仪器</div>
              <div class="document-content">
                <p>气相色谱仪 GC-2030（岛津）</p>
                <p>分光光度计 UV-2600（岛津）</p>
                <p>空气采样器 QC-2A（青岛崂山）</p>
              </div>
            </div>

            <div class="document-section">
              <div class="section-title">四、检测结果</div>
              <div class="document-content">
                <p>
                  详细检测数据见附表。经检测，12个检测点位中，11个点位所有指标均符合GB
                  50325-2020标准要求，1个点位甲醛指标超标。
                </p>
              </div>
            </div>

            <div class="document-section">
              <div class="section-title">五、检测结论</div>
              <div class="document-content">
                <p>
                  根据检测结果，受检区域室内空气质量部分指标不符合GB
                  50325-2020《民用建筑工程室内环境污染控制标准》要求，建议采取相应措施改善室内空气质量。
                </p>
              </div>
            </div>

            <div style="margin-top: 40px; text-align: right">
              <p>检测机构：星旺检测技术有限公司</p>
              <p>报告日期：2025年9月6日</p>
              <p>报告编号：XW250903-100-RPT-001</p>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" onclick="hideReportModal()">
            关闭
          </button>
        </div>
      </div>
    </div>

    <script>
      // 获取URL参数
      const urlParams = new URLSearchParams(window.location.search)
      const reportNumber = urlParams.get('report') || 'XW250903-100-RPT-001'

      // 设置页面标题
      document.addEventListener('DOMContentLoaded', () => {
        if (window.limsNav) {
          window.limsNav.setPageTitle('已生成报告详情')
        }
        // 更新页面中的报告编号
        document.querySelector('.report-number').textContent = reportNumber
        document.getElementById('modal-report-number').textContent =
          reportNumber
      })

      // 提交审核
      function submitForReview() {
        document.getElementById('submit-modal').style.display = 'block'
      }

      // 隐藏提交审核弹窗
      function hideSubmitModal() {
        document.getElementById('submit-modal').style.display = 'none'
      }

      // 确认提交审核
      function confirmSubmit() {
        // 这里可以添加实际的提交逻辑
        hideSubmitModal()

        // 更新状态显示
        document.getElementById('report-status').textContent = '待审核'
        document.getElementById('report-status').className =
          'report-status pending'
        document.getElementById('status-text').textContent = '待审核'
        document.getElementById('status-indicator').className =
          'status-indicator pending'

        // 更新操作历史
        const historyContainer = document.querySelector(
          '.status-card:last-child > div:last-child'
        )
        const newHistoryItem = document.createElement('div')
        newHistoryItem.style.cssText =
          'display: flex; align-items: center; gap: 12px; padding: 12px; background: #fef3c7; border-radius: 6px;'
        newHistoryItem.innerHTML = `
                <div style="width: 8px; height: 8px; background: #f59e0b; border-radius: 50%;"></div>
                <div style="flex: 1;">
                    <div style="font-size: 13px; font-weight: 500;">提交审核</div>
                    <div style="font-size: 11px; color: #6b7280;">${new Date().toLocaleString('zh-CN')} - ${sessionStorage.getItem('username') || '编制员'}</div>
                </div>
            `
        historyContainer.insertBefore(
          newHistoryItem,
          historyContainer.lastElementChild
        )

        alert('报告已成功提交审核！审核人员将收到通知并开始审核流程。')

        // 可选择性跳转回工作台
        setTimeout(() => {
          if (confirm('是否返回报告编制工作台？')) {
            window.location.href = 'report-dashboard.html'
          }
        }, 1000)
      }

      // 重新生成
      function regenerateReport() {
        document.getElementById('regenerate-modal').style.display = 'block'
      }

      // 隐藏重新生成弹窗
      function hideRegenerateModal() {
        document.getElementById('regenerate-modal').style.display = 'none'
      }

      // 确认重新生成
      function confirmRegenerate() {
        hideRegenerateModal()
        console.log(`重新生成报告: ${reportNumber}`)
        // 跳转到报告生成页面
        window.location.href = `report-generation.html?report=${reportNumber}`
      }

      // 显示报告预览
      function showReportPreview() {
        document.getElementById('report-modal').style.display = 'block'
      }

      // 隐藏报告预览
      function hideReportModal() {
        document.getElementById('report-modal').style.display = 'none'
      }

      // 点击弹窗外部关闭
      window.addEventListener('click', function (event) {
        if (event.target.classList.contains('modal')) {
          event.target.style.display = 'none'
        }
      })

      // 返回工作台功能
      function backToWorkspace() {
        // 跳转到报告编制工作台
        window.location.href = 'report-dashboard.html'
      }

      // 页面加载动画
      window.addEventListener('load', function () {
        const cards = document.querySelectorAll('.info-card, .status-card')
        cards.forEach((card, index) => {
          card.style.opacity = '0'
          card.style.transform = 'translateY(20px)'
          setTimeout(() => {
            card.style.transition = 'all 0.3s ease'
            card.style.opacity = '1'
            card.style.transform = 'translateY(0)'
          }, index * 100)
        })
      })
    </script>
  </body>
</html>
