<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>订单审核工作台 - LIMS-XW</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC',
          'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
        background: #f5f7fa;
        min-height: 100vh;
        margin: 0;
      }

      /* 主内容区 */
      .main-content {
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
      }

      /* 页面标题 */
      .page-header {
        margin-bottom: 24px;
      }

      .page-title {
        font-size: 28px;
        color: #1f2937;
        font-weight: bold;
        margin-bottom: 8px;
      }

      .breadcrumb {
        color: #6b7280;
        font-size: 14px;
      }

      /* 统计卡片 */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition:
          transform 0.2s,
          box-shadow 0.2s;
      }

      .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .stat-card.urgent {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      }

      .stat-label {
        color: #6b7280;
        font-size: 14px;
        margin-bottom: 8px;
      }

      .stat-value {
        font-size: 32px;
        font-weight: bold;
        color: #1f2937;
      }

      .stat-card.urgent .stat-value {
        color: #92400e;
      }

      /* 搜索栏 */
      .search-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .search-title {
        font-size: 20px;
        font-weight: bold;
        color: #1f2937;
      }

      .search-controls {
        display: flex;
        gap: 12px;
      }

      .search-input {
        padding: 8px 16px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        font-size: 14px;
        width: 250px;
      }

      .filter-checkbox {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .filter-checkbox:hover {
        border-color: #667eea;
        background: #f9fafb;
      }

      .filter-checkbox input[type='checkbox'] {
        cursor: pointer;
      }

      .filter-checkbox label {
        cursor: pointer;
        font-size: 14px;
        color: #374151;
      }

      /* 订单卡片列表 */
      .order-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
        gap: 20px;
      }

      .order-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }

      .order-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
      }

      .order-card.urgent::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
      }

      .order-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 16px;
      }

      .order-id {
        font-size: 16px;
        font-weight: bold;
        color: #667eea;
        cursor: pointer;
      }

      .order-id:hover {
        text-decoration: underline;
      }

      .urgent-badge {
        padding: 4px 8px;
        background: #ef4444;
        color: white;
        border-radius: 4px;
        font-size: 12px;
        font-weight: bold;
      }

      .order-info {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 16px;
      }

      .info-row {
        display: flex;
        gap: 8px;
        font-size: 14px;
      }

      .info-label {
        color: #6b7280;
        min-width: 80px;
      }

      .info-value {
        color: #1f2937;
        font-weight: 500;
        flex: 1;
      }

      .order-actions {
        display: flex;
        gap: 10px;
        padding-top: 16px;
        border-top: 1px solid #e5e7eb;
      }

      .btn {
        flex: 1;
        padding: 10px 16px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
      }

      .btn-approve {
        background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
        color: white;
      }

      .btn-approve:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .btn-reject {
        background: white;
        color: #ef4444;
        border: 1px solid #ef4444;
      }

      .btn-reject:hover {
        background: #fef2f2;
      }

      .btn-view {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-view:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      /* 空状态 */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        background: white;
        border-radius: 12px;
        margin-top: 40px;
      }

      .empty-icon {
        font-size: 64px;
        color: #e5e7eb;
        margin-bottom: 16px;
      }

      .empty-title {
        font-size: 20px;
        font-weight: bold;
        color: #6b7280;
        margin-bottom: 8px;
      }

      .empty-desc {
        font-size: 14px;
        color: #9ca3af;
      }

      /* 分页控件样式 */
      .pagination-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background: white;
        border-radius: 12px;
        margin-top: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        flex-wrap: wrap;
        gap: 16px;
      }

      .pagination-info {
        color: #6b7280;
        font-size: 14px;
      }

      .pagination-info strong {
        color: #1f2937;
        font-weight: 600;
      }

      .pagination-controls {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .page-btn {
        padding: 8px 14px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        color: #6b7280;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s;
        min-width: 40px;
        text-align: center;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 500;
      }

      .page-btn:hover:not(:disabled) {
        background: #f9fafb;
        border-color: #667eea;
        color: #667eea;
        transform: translateY(-1px);
      }

      .page-btn.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-color: #667eea;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.25);
      }

      .page-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
        background: #f3f4f6;
      }

      .page-btn.nav-btn {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        font-weight: 500;
      }

      .page-btn.nav-btn svg {
        width: 14px;
        height: 14px;
      }

      #pageNumbers {
        display: flex;
        gap: 4px;
      }

      .page-jump {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-left: 16px;
        padding-left: 16px;
        border-left: 1px solid #e5e7eb;
      }

      .page-jump-label {
        color: #6b7280;
        font-size: 14px;
      }

      .page-jump-input {
        width: 60px;
        padding: 8px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        font-size: 14px;
        text-align: center;
        transition: all 0.2s;
      }

      .page-jump-input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .page-jump-btn {
        padding: 8px 14px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
      }

      .page-jump-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      /* 加载动画 */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.95);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .loading-overlay.active {
        display: flex;
      }

      .loading-spinner {
        width: 48px;
        height: 48px;
        border: 4px solid #f3f4f6;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        margin-top: 16px;
        color: #6b7280;
        font-size: 14px;
      }

      /* 页面过渡动画 */
      .order-grid {
        animation: fadeIn 0.3s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* 响应式设计 */
      @media (max-width: 768px) {
        .pagination-container {
          flex-direction: column;
          align-items: stretch;
          padding: 16px;
        }

        .pagination-controls {
          justify-content: center;
          flex-wrap: wrap;
        }

        .pagination-info {
          text-align: center;
          margin-bottom: 12px;
        }

        .page-jump {
          margin-left: 0;
          margin-top: 12px;
          padding-left: 0;
          border-left: none;
          border-top: 1px solid #e5e7eb;
          padding-top: 12px;
          width: 100%;
          justify-content: center;
        }

        .page-btn.nav-btn {
          font-size: 12px;
          padding: 6px 8px;
        }

        .page-btn.nav-btn svg {
          display: none;
        }

        #pageNumbers {
          order: 3;
          width: 100%;
          justify-content: center;
          margin: 8px 0;
        }
      }
    </style>
  </head>
  <body>
    <script src="navigation.js"></script>

    <!-- 主内容 -->
    <div class="main-content">
      <!-- 页面头部 -->
      <div class="page-header">
        <h2 class="page-title">订单审核工作台</h2>
        <div class="breadcrumb">首页 / 订单审核</div>
      </div>

      <!-- 统计卡片 -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">待审核订单数</div>
          <div class="stat-value">12</div>
        </div>
        <div class="stat-card urgent">
          <div class="stat-label">加急订单数</div>
          <div class="stat-value">3</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">今日已审核</div>
          <div class="stat-value">28</div>
        </div>
      </div>

      <!-- 搜索栏 -->
      <div class="search-bar">
        <h3 class="search-title">待审核订单列表</h3>
        <div class="search-controls">
          <input
            type="text"
            class="search-input"
            placeholder="搜索项目编号..."
          />
          <div class="filter-checkbox">
            <input type="checkbox" id="urgentOnly" checked />
            <label for="urgentOnly">仅显示加急订单</label>
          </div>
        </div>
      </div>

      <!-- 订单卡片列表 -->
      <div class="order-grid" id="orderGrid">
        <!-- 订单卡片将通过JavaScript动态生成 -->
      </div>

      <!-- 分页控件 -->
      <div class="pagination-container" id="paginationContainer">
        <div class="pagination-info">
          显示 <strong id="startRecord">1</strong> -
          <strong id="endRecord">10</strong> 条， 共
          <strong id="totalRecords">0</strong> 条待审核
        </div>
        <div class="pagination-controls">
          <button
            class="page-btn nav-btn"
            id="firstPageBtn"
            onclick="goToPage(1)"
            disabled
          >
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="11 17 6 12 11 7"></polyline>
              <polyline points="18 17 13 12 18 7"></polyline>
            </svg>
            首页
          </button>
          <button
            class="page-btn nav-btn"
            id="prevPageBtn"
            onclick="previousPage()"
            disabled
          >
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
            上一页
          </button>
          <div id="pageNumbers">
            <!-- 动态生成的页码按钮 -->
          </div>
          <button
            class="page-btn nav-btn"
            id="nextPageBtn"
            onclick="nextPage()"
          >
            下一页
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
          <button
            class="page-btn nav-btn"
            id="lastPageBtn"
            onclick="goToPage(totalPages)"
          >
            末页
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="13 17 18 12 13 7"></polyline>
              <polyline points="6 17 11 12 6 7"></polyline>
            </svg>
          </button>
          <div class="page-jump">
            <span class="page-jump-label">跳转到</span>
            <input
              type="number"
              class="page-jump-input"
              id="pageJumpInput"
              min="1"
              placeholder="页码"
            />
            <button class="page-jump-btn" onclick="jumpToPage()">GO</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 加载动画 -->
    <div class="loading-overlay" id="loadingOverlay">
      <div>
        <div class="loading-spinner"></div>
        <div class="loading-text">加载中...</div>
      </div>
    </div>

    <script>
      // 全局变量
      let allOrders = [] // 所有订单数据
      let filteredOrders = [] // 过滤后的订单数据
      let currentPage = 1 // 当前页码
      const itemsPerPage = 10 // 每页显示数量
      let totalPages = 0 // 总页数

      // 生成测试订单数据
      function generateTestOrders() {
        const customers = [
          '深圳科技创新中心',
          '广州医药研究院',
          '东莞食品加工厂',
          '佛山纺织工厂',
          '惠州建材公司',
          '中山物流园区',
          '珠海电子科技园',
          '江门化工厂',
          '肇庆制药公司',
          '清远饮料厂',
          '韶关钢铁厂',
          '湛江海产品加工厂',
          '茂名石化公司',
          '阳江五金厂',
          '云浮石材厂',
          '潮州陶瓷厂',
          '汕头玩具厂',
          '揭阳塑料制品厂',
          '梅州农产品公司',
          '河源电子厂',
          '汕尾渔业公司',
          '惠州电池厂',
          '东莞家具厂',
          '中山灯饰城',
          '佛山陶瓷城',
          '广州汽车制造厂',
          '深圳生物科技园',
          '珠海航空产业园'
        ]

        const units = [
          '生产车间A区',
          '生产车间B区',
          '办公楼一层',
          '办公楼二层',
          '办公楼三层',
          '实验室',
          '研发中心',
          '仓储区域',
          '食堂',
          '宿舍楼',
          '净化车间',
          '无菌室',
          '包装车间',
          '原料仓库',
          '成品仓库',
          '质检中心',
          '污水处理站',
          '锅炉房',
          '配电室',
          '停车场'
        ]

        const testTypes = [
          '洁净室环境',
          '生活饮用水',
          '工业废水',
          '噪音检测',
          '空气质量',
          '50325-2020',
          '18883-2022',
          '土壤检测',
          '食品接触材料',
          '化学品检测',
          '微生物检测',
          '重金属检测',
          '有机污染物',
          '放射性检测',
          'VOCs检测'
        ]

        const orders = []
        const today = new Date()

        for (let i = 0; i < 30; i++) {
          const isUrgent = Math.random() < 0.3 // 30%的订单是加急的
          const submitTime = new Date(today)
          submitTime.setHours(today.getHours() - Math.floor(Math.random() * 72)) // 过去72小时内的随机时间

          orders.push({
            id: `XW${today.getFullYear()}${String(today.getMonth() + 1).padStart(2, '0')}${String(today.getDate()).padStart(2, '0')}-${String(100 + i).padStart(3, '0')}`,
            customer: customers[Math.floor(Math.random() * customers.length)],
            unit: units[Math.floor(Math.random() * units.length)],
            testType: testTypes[Math.floor(Math.random() * testTypes.length)],
            submitTime: formatDateTime(submitTime),
            isUrgent: isUrgent
          })
        }

        // 按提交时间倒序排序（最新的在前）
        orders.sort((a, b) => {
          // 先按加急状态排序
          if (a.isUrgent && !b.isUrgent) return -1
          if (!a.isUrgent && b.isUrgent) return 1
          // 再按时间排序
          return new Date(b.submitTime) - new Date(a.submitTime)
        })

        return orders
      }

      // 格式化日期时间
      function formatDateTime(date) {
        const year = date.getFullYear()
        const month = String(date.getMonth() + 1).padStart(2, '0')
        const day = String(date.getDate()).padStart(2, '0')
        const hours = String(date.getHours()).padStart(2, '0')
        const minutes = String(date.getMinutes()).padStart(2, '0')
        return `${year}-${month}-${day} ${hours}:${minutes}`
      }

      // 创建订单卡片HTML
      function createOrderCard(order) {
        return `
                <div class="order-card ${order.isUrgent ? 'urgent' : ''}">
                    <div class="order-header">
                        <div class="order-id" onclick="window.location.href='order-review.html'">${order.id}</div>
                        ${order.isUrgent ? '<span class="urgent-badge">加急</span>' : ''}
                    </div>
                    <div class="order-info">
                        <div class="info-row">
                            <span class="info-label">客户名称：</span>
                            <span class="info-value">${order.customer}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">受检单位：</span>
                            <span class="info-value">${order.unit}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">检测类型：</span>
                            <span class="info-value"${order.testType.includes('50325') || order.testType.includes('18883') ? ' style="color: #059669; font-weight: 500;"' : ''}>${order.testType}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">提交时间：</span>
                            <span class="info-value">${order.submitTime}</span>
                        </div>
                    </div>
                    <div class="order-actions">
                        <button class="btn btn-view" onclick="window.location.href='order-review.html'">查看详情</button>
                        <button class="btn btn-approve" onclick="approveOrder('${order.id}')">快速通过</button>
                        <button class="btn btn-reject" onclick="rejectOrder('${order.id}')">驳回</button>
                    </div>
                </div>
            `
      }

      // 显示加载动画
      function showLoading() {
        document.getElementById('loadingOverlay').classList.add('active')
      }

      // 隐藏加载动画
      function hideLoading() {
        setTimeout(() => {
          document.getElementById('loadingOverlay').classList.remove('active')
        }, 300)
      }

      // 渲染订单列表
      function renderOrders() {
        showLoading()

        const orderGrid = document.getElementById('orderGrid')
        const startIndex = (currentPage - 1) * itemsPerPage
        const endIndex = Math.min(
          startIndex + itemsPerPage,
          filteredOrders.length
        )
        const pageOrders = filteredOrders.slice(startIndex, endIndex)

        // 清空并重新填充订单列表
        orderGrid.innerHTML = ''

        if (pageOrders.length === 0) {
          orderGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">📋</div>
                        <div class="empty-title">暂无待审核订单</div>
                        <div class="empty-desc">当前页面没有需要审核的订单</div>
                    </div>
                `
        } else {
          pageOrders.forEach(order => {
            orderGrid.innerHTML += createOrderCard(order)
          })
        }

        // 更新分页信息
        updatePaginationInfo()

        // 滚动到顶部
        window.scrollTo({ top: 0, behavior: 'smooth' })

        hideLoading()
      }

      // 更新分页信息
      function updatePaginationInfo() {
        const startRecord =
          filteredOrders.length === 0 ? 0 : (currentPage - 1) * itemsPerPage + 1
        const endRecord = Math.min(
          currentPage * itemsPerPage,
          filteredOrders.length
        )

        document.getElementById('startRecord').textContent = startRecord
        document.getElementById('endRecord').textContent = endRecord
        document.getElementById('totalRecords').textContent =
          filteredOrders.length

        // 更新统计卡片
        const urgentCount = filteredOrders.filter(o => o.isUrgent).length
        document.querySelector(
          '.stat-card:nth-child(1) .stat-value'
        ).textContent = filteredOrders.length
        document.querySelector(
          '.stat-card:nth-child(2) .stat-value'
        ).textContent = urgentCount

        // 更新分页按钮状态
        updatePaginationButtons()
      }

      // 更新分页按钮
      function updatePaginationButtons() {
        totalPages = Math.ceil(filteredOrders.length / itemsPerPage) || 1

        // 更新导航按钮状态
        document.getElementById('firstPageBtn').disabled = currentPage === 1
        document.getElementById('prevPageBtn').disabled = currentPage === 1
        document.getElementById('nextPageBtn').disabled =
          currentPage === totalPages
        document.getElementById('lastPageBtn').disabled =
          currentPage === totalPages

        // 生成页码按钮
        const pageNumbers = document.getElementById('pageNumbers')
        pageNumbers.innerHTML = ''

        // 计算显示的页码范围
        let startPage = Math.max(1, currentPage - 2)
        let endPage = Math.min(totalPages, startPage + 4)

        if (endPage - startPage < 4) {
          startPage = Math.max(1, endPage - 4)
        }

        // 如果不是从第一页开始，添加省略号
        if (startPage > 1) {
          const dots = document.createElement('span')
          dots.textContent = '...'
          dots.style.padding = '0 8px'
          dots.style.color = '#9ca3af'
          pageNumbers.appendChild(dots)
        }

        // 添加页码按钮
        for (let i = startPage; i <= endPage; i++) {
          const btn = document.createElement('button')
          btn.className = 'page-btn'
          btn.textContent = i
          btn.onclick = () => goToPage(i)

          if (i === currentPage) {
            btn.classList.add('active')
          }

          pageNumbers.appendChild(btn)
        }

        // 如果不是到最后一页，添加省略号
        if (endPage < totalPages) {
          const dots = document.createElement('span')
          dots.textContent = '...'
          dots.style.padding = '0 8px'
          dots.style.color = '#9ca3af'
          pageNumbers.appendChild(dots)
        }

        // 更新跳转输入框的最大值
        document.getElementById('pageJumpInput').max = totalPages
      }

      // 跳转到指定页
      function goToPage(page) {
        if (page < 1) page = 1
        if (page > totalPages) page = totalPages

        currentPage = page
        renderOrders()
      }

      // 上一页
      function previousPage() {
        if (currentPage > 1) {
          goToPage(currentPage - 1)
        }
      }

      // 下一页
      function nextPage() {
        if (currentPage < totalPages) {
          goToPage(currentPage + 1)
        }
      }

      // 跳转到输入的页码
      function jumpToPage() {
        const input = document.getElementById('pageJumpInput')
        const page = parseInt(input.value)

        if (!isNaN(page)) {
          goToPage(page)
          input.value = '' // 清空输入框
        }
      }

      // 搜索订单
      function searchOrders(keyword) {
        if (!keyword) {
          filteredOrders = [...allOrders]
        } else {
          const lowerKeyword = keyword.toLowerCase()
          filteredOrders = allOrders.filter(
            order =>
              order.id.toLowerCase().includes(lowerKeyword) ||
              order.customer.toLowerCase().includes(lowerKeyword) ||
              order.unit.toLowerCase().includes(lowerKeyword) ||
              order.testType.toLowerCase().includes(lowerKeyword)
          )
        }

        currentPage = 1 // 重置到第一页
        renderOrders()
      }

      // 过滤加急订单
      function filterUrgentOrders(urgentOnly) {
        const searchKeyword = document.querySelector('.search-input').value

        if (urgentOnly) {
          filteredOrders = allOrders.filter(order => order.isUrgent)
        } else {
          filteredOrders = [...allOrders]
        }

        // 如果有搜索关键词，再次过滤
        if (searchKeyword) {
          searchOrders(searchKeyword)
        } else {
          currentPage = 1
          renderOrders()
        }
      }

      // 快速通过订单
      function approveOrder(orderId) {
        if (confirm(`确定要通过订单 ${orderId} 吗？`)) {
          showLoading()

          // 模拟审核操作
          setTimeout(() => {
            // 从列表中移除该订单
            const index = allOrders.findIndex(o => o.id === orderId)
            if (index !== -1) {
              allOrders.splice(index, 1)
              filteredOrders = filteredOrders.filter(o => o.id !== orderId)

              // 更新今日已审核数量
              const todayApproved = document.querySelector(
                '.stat-card:nth-child(3) .stat-value'
              )
              todayApproved.textContent =
                parseInt(todayApproved.textContent) + 1

              // 如果当前页没有数据了，返回上一页
              const newTotalPages =
                Math.ceil(filteredOrders.length / itemsPerPage) || 1
              if (currentPage > newTotalPages) {
                currentPage = newTotalPages
              }

              renderOrders()
              alert(`订单 ${orderId} 已通过审核！`)
            }

            hideLoading()
          }, 500)
        }
      }

      // 驳回订单
      function rejectOrder(orderId) {
        const reason = prompt(`请输入驳回订单 ${orderId} 的原因：`)
        if (reason) {
          showLoading()

          // 模拟驳回操作
          setTimeout(() => {
            // 从列表中移除该订单
            const index = allOrders.findIndex(o => o.id === orderId)
            if (index !== -1) {
              allOrders.splice(index, 1)
              filteredOrders = filteredOrders.filter(o => o.id !== orderId)

              // 如果当前页没有数据了，返回上一页
              const newTotalPages =
                Math.ceil(filteredOrders.length / itemsPerPage) || 1
              if (currentPage > newTotalPages) {
                currentPage = newTotalPages
              }

              renderOrders()
              alert(`订单 ${orderId} 已被驳回！\n驳回原因：${reason}`)
            }

            hideLoading()
          }, 500)
        }
      }

      // 初始化页面
      document.addEventListener('DOMContentLoaded', () => {
        // 设置页面标题
        if (window.limsNav) {
          window.limsNav.setPageTitle('订单审核工作台')
        }

        // 生成测试数据
        allOrders = generateTestOrders()
        filteredOrders = [...allOrders]

        // 初始渲染
        renderOrders()

        // 绑定搜索事件
        const searchInput = document.querySelector('.search-input')
        searchInput.addEventListener('input', function (e) {
          searchOrders(e.target.value)
        })

        // 绑定加急筛选事件
        document
          .getElementById('urgentOnly')
          .addEventListener('change', function (e) {
            filterUrgentOrders(e.target.checked)
          })

        // 绑定回车键跳转
        document
          .getElementById('pageJumpInput')
          .addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
              jumpToPage()
            }
          })

        // 默认显示所有订单
        setTimeout(() => {
          document.getElementById('urgentOnly').checked = false
          filterUrgentOrders(false)
        }, 100)
      })
    </script>
  </body>
</html>
