<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>è®¢å•å®¡æ ¸å·¥ä½œå° - LIMS-XW</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC',
          'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
        background: #f5f7fa;
        min-height: 100vh;
        margin: 0;
      }

      /* ä¸»å†…å®¹åŒº */
      .main-content {
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
      }

      /* é¡µé¢æ ‡é¢˜ */
      .page-header {
        margin-bottom: 24px;
      }

      .page-title {
        font-size: 28px;
        color: #1f2937;
        font-weight: bold;
        margin-bottom: 8px;
      }

      .breadcrumb {
        color: #6b7280;
        font-size: 14px;
      }

      /* ç»Ÿè®¡å¡ç‰‡ */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition:
          transform 0.2s,
          box-shadow 0.2s;
      }

      .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .stat-card.urgent {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      }

      .stat-label {
        color: #6b7280;
        font-size: 14px;
        margin-bottom: 8px;
      }

      .stat-value {
        font-size: 32px;
        font-weight: bold;
        color: #1f2937;
      }

      .stat-card.urgent .stat-value {
        color: #92400e;
      }

      /* æœç´¢æ  */
      .search-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .search-title {
        font-size: 20px;
        font-weight: bold;
        color: #1f2937;
      }

      .search-controls {
        display: flex;
        gap: 12px;
      }

      .search-input {
        padding: 8px 16px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        font-size: 14px;
        width: 250px;
      }

      .filter-checkbox {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .filter-checkbox:hover {
        border-color: #667eea;
        background: #f9fafb;
      }

      .filter-checkbox input[type='checkbox'] {
        cursor: pointer;
      }

      .filter-checkbox label {
        cursor: pointer;
        font-size: 14px;
        color: #374151;
      }

      /* è®¢å•å¡ç‰‡åˆ—è¡¨ */
      .order-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
        gap: 20px;
      }

      .order-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }

      .order-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
      }

      .order-card.urgent::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
      }

      .order-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 16px;
      }

      .order-id {
        font-size: 16px;
        font-weight: bold;
        color: #667eea;
        cursor: pointer;
      }

      .order-id:hover {
        text-decoration: underline;
      }

      .urgent-badge {
        padding: 4px 8px;
        background: #ef4444;
        color: white;
        border-radius: 4px;
        font-size: 12px;
        font-weight: bold;
      }

      .order-info {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 16px;
      }

      .info-row {
        display: flex;
        gap: 8px;
        font-size: 14px;
      }

      .info-label {
        color: #6b7280;
        min-width: 80px;
      }

      .info-value {
        color: #1f2937;
        font-weight: 500;
        flex: 1;
      }

      .order-actions {
        display: flex;
        gap: 10px;
        padding-top: 16px;
        border-top: 1px solid #e5e7eb;
      }

      .btn {
        flex: 1;
        padding: 10px 16px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
      }

      .btn-approve {
        background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
        color: white;
      }

      .btn-approve:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .btn-reject {
        background: white;
        color: #ef4444;
        border: 1px solid #ef4444;
      }

      .btn-reject:hover {
        background: #fef2f2;
      }

      .btn-view {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-view:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      /* ç©ºçŠ¶æ€ */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        background: white;
        border-radius: 12px;
        margin-top: 40px;
      }

      .empty-icon {
        font-size: 64px;
        color: #e5e7eb;
        margin-bottom: 16px;
      }

      .empty-title {
        font-size: 20px;
        font-weight: bold;
        color: #6b7280;
        margin-bottom: 8px;
      }

      .empty-desc {
        font-size: 14px;
        color: #9ca3af;
      }

      /* åˆ†é¡µæ§ä»¶æ ·å¼ */
      .pagination-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background: white;
        border-radius: 12px;
        margin-top: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        flex-wrap: wrap;
        gap: 16px;
      }

      .pagination-info {
        color: #6b7280;
        font-size: 14px;
      }

      .pagination-info strong {
        color: #1f2937;
        font-weight: 600;
      }

      .pagination-controls {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .page-btn {
        padding: 8px 14px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        color: #6b7280;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s;
        min-width: 40px;
        text-align: center;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 500;
      }

      .page-btn:hover:not(:disabled) {
        background: #f9fafb;
        border-color: #667eea;
        color: #667eea;
        transform: translateY(-1px);
      }

      .page-btn.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-color: #667eea;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.25);
      }

      .page-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
        background: #f3f4f6;
      }

      .page-btn.nav-btn {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        font-weight: 500;
      }

      .page-btn.nav-btn svg {
        width: 14px;
        height: 14px;
      }

      #pageNumbers {
        display: flex;
        gap: 4px;
      }

      .page-jump {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-left: 16px;
        padding-left: 16px;
        border-left: 1px solid #e5e7eb;
      }

      .page-jump-label {
        color: #6b7280;
        font-size: 14px;
      }

      .page-jump-input {
        width: 60px;
        padding: 8px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        font-size: 14px;
        text-align: center;
        transition: all 0.2s;
      }

      .page-jump-input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .page-jump-btn {
        padding: 8px 14px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
      }

      .page-jump-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      /* åŠ è½½åŠ¨ç”» */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(255, 255, 255, 0.95);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .loading-overlay.active {
        display: flex;
      }

      .loading-spinner {
        width: 48px;
        height: 48px;
        border: 4px solid #f3f4f6;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        margin-top: 16px;
        color: #6b7280;
        font-size: 14px;
      }

      /* é¡µé¢è¿‡æ¸¡åŠ¨ç”» */
      .order-grid {
        animation: fadeIn 0.3s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* å“åº”å¼è®¾è®¡ */
      @media (max-width: 768px) {
        .pagination-container {
          flex-direction: column;
          align-items: stretch;
          padding: 16px;
        }

        .pagination-controls {
          justify-content: center;
          flex-wrap: wrap;
        }

        .pagination-info {
          text-align: center;
          margin-bottom: 12px;
        }

        .page-jump {
          margin-left: 0;
          margin-top: 12px;
          padding-left: 0;
          border-left: none;
          border-top: 1px solid #e5e7eb;
          padding-top: 12px;
          width: 100%;
          justify-content: center;
        }

        .page-btn.nav-btn {
          font-size: 12px;
          padding: 6px 8px;
        }

        .page-btn.nav-btn svg {
          display: none;
        }

        #pageNumbers {
          order: 3;
          width: 100%;
          justify-content: center;
          margin: 8px 0;
        }
      }
    </style>
  </head>
  <body>
    <script src="navigation.js"></script>

    <!-- ä¸»å†…å®¹ -->
    <div class="main-content">
      <!-- é¡µé¢å¤´éƒ¨ -->
      <div class="page-header">
        <h2 class="page-title">è®¢å•å®¡æ ¸å·¥ä½œå°</h2>
        <div class="breadcrumb">é¦–é¡µ / è®¢å•å®¡æ ¸</div>
      </div>

      <!-- ç»Ÿè®¡å¡ç‰‡ -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">å¾…å®¡æ ¸è®¢å•æ•°</div>
          <div class="stat-value">12</div>
        </div>
        <div class="stat-card urgent">
          <div class="stat-label">åŠ æ€¥è®¢å•æ•°</div>
          <div class="stat-value">3</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">ä»Šæ—¥å·²å®¡æ ¸</div>
          <div class="stat-value">28</div>
        </div>
      </div>

      <!-- æœç´¢æ  -->
      <div class="search-bar">
        <h3 class="search-title">å¾…å®¡æ ¸è®¢å•åˆ—è¡¨</h3>
        <div class="search-controls">
          <input
            type="text"
            class="search-input"
            placeholder="æœç´¢é¡¹ç›®ç¼–å·..."
          />
          <div class="filter-checkbox">
            <input type="checkbox" id="urgentOnly" checked />
            <label for="urgentOnly">ä»…æ˜¾ç¤ºåŠ æ€¥è®¢å•</label>
          </div>
        </div>
      </div>

      <!-- è®¢å•å¡ç‰‡åˆ—è¡¨ -->
      <div class="order-grid" id="orderGrid">
        <!-- è®¢å•å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
      </div>

      <!-- åˆ†é¡µæ§ä»¶ -->
      <div class="pagination-container" id="paginationContainer">
        <div class="pagination-info">
          æ˜¾ç¤º <strong id="startRecord">1</strong> -
          <strong id="endRecord">10</strong> æ¡ï¼Œ å…±
          <strong id="totalRecords">0</strong> æ¡å¾…å®¡æ ¸
        </div>
        <div class="pagination-controls">
          <button
            class="page-btn nav-btn"
            id="firstPageBtn"
            onclick="goToPage(1)"
            disabled
          >
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="11 17 6 12 11 7"></polyline>
              <polyline points="18 17 13 12 18 7"></polyline>
            </svg>
            é¦–é¡µ
          </button>
          <button
            class="page-btn nav-btn"
            id="prevPageBtn"
            onclick="previousPage()"
            disabled
          >
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
            ä¸Šä¸€é¡µ
          </button>
          <div id="pageNumbers">
            <!-- åŠ¨æ€ç”Ÿæˆçš„é¡µç æŒ‰é’® -->
          </div>
          <button
            class="page-btn nav-btn"
            id="nextPageBtn"
            onclick="nextPage()"
          >
            ä¸‹ä¸€é¡µ
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
          <button
            class="page-btn nav-btn"
            id="lastPageBtn"
            onclick="goToPage(totalPages)"
          >
            æœ«é¡µ
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="13 17 18 12 13 7"></polyline>
              <polyline points="6 17 11 12 6 7"></polyline>
            </svg>
          </button>
          <div class="page-jump">
            <span class="page-jump-label">è·³è½¬åˆ°</span>
            <input
              type="number"
              class="page-jump-input"
              id="pageJumpInput"
              min="1"
              placeholder="é¡µç "
            />
            <button class="page-jump-btn" onclick="jumpToPage()">GO</button>
          </div>
        </div>
      </div>
    </div>

    <!-- åŠ è½½åŠ¨ç”» -->
    <div class="loading-overlay" id="loadingOverlay">
      <div>
        <div class="loading-spinner"></div>
        <div class="loading-text">åŠ è½½ä¸­...</div>
      </div>
    </div>

    <script>
      // å…¨å±€å˜é‡
      let allOrders = [] // æ‰€æœ‰è®¢å•æ•°æ®
      let filteredOrders = [] // è¿‡æ»¤åçš„è®¢å•æ•°æ®
      let currentPage = 1 // å½“å‰é¡µç 
      const itemsPerPage = 10 // æ¯é¡µæ˜¾ç¤ºæ•°é‡
      let totalPages = 0 // æ€»é¡µæ•°

      // ç”Ÿæˆæµ‹è¯•è®¢å•æ•°æ®
      function generateTestOrders() {
        const customers = [
          'æ·±åœ³ç§‘æŠ€åˆ›æ–°ä¸­å¿ƒ',
          'å¹¿å·åŒ»è¯ç ”ç©¶é™¢',
          'ä¸œèé£Ÿå“åŠ å·¥å‚',
          'ä½›å±±çººç»‡å·¥å‚',
          'æƒ å·å»ºæå…¬å¸',
          'ä¸­å±±ç‰©æµå›­åŒº',
          'ç æµ·ç”µå­ç§‘æŠ€å›­',
          'æ±Ÿé—¨åŒ–å·¥å‚',
          'è‚‡åº†åˆ¶è¯å…¬å¸',
          'æ¸…è¿œé¥®æ–™å‚',
          'éŸ¶å…³é’¢é“å‚',
          'æ¹›æ±Ÿæµ·äº§å“åŠ å·¥å‚',
          'èŒ‚åçŸ³åŒ–å…¬å¸',
          'é˜³æ±Ÿäº”é‡‘å‚',
          'äº‘æµ®çŸ³æå‚',
          'æ½®å·é™¶ç“·å‚',
          'æ±•å¤´ç©å…·å‚',
          'æ­é˜³å¡‘æ–™åˆ¶å“å‚',
          'æ¢…å·å†œäº§å“å…¬å¸',
          'æ²³æºç”µå­å‚',
          'æ±•å°¾æ¸”ä¸šå…¬å¸',
          'æƒ å·ç”µæ± å‚',
          'ä¸œèå®¶å…·å‚',
          'ä¸­å±±ç¯é¥°åŸ',
          'ä½›å±±é™¶ç“·åŸ',
          'å¹¿å·æ±½è½¦åˆ¶é€ å‚',
          'æ·±åœ³ç”Ÿç‰©ç§‘æŠ€å›­',
          'ç æµ·èˆªç©ºäº§ä¸šå›­'
        ]

        const units = [
          'ç”Ÿäº§è½¦é—´AåŒº',
          'ç”Ÿäº§è½¦é—´BåŒº',
          'åŠå…¬æ¥¼ä¸€å±‚',
          'åŠå…¬æ¥¼äºŒå±‚',
          'åŠå…¬æ¥¼ä¸‰å±‚',
          'å®éªŒå®¤',
          'ç ”å‘ä¸­å¿ƒ',
          'ä»“å‚¨åŒºåŸŸ',
          'é£Ÿå ‚',
          'å®¿èˆæ¥¼',
          'å‡€åŒ–è½¦é—´',
          'æ— èŒå®¤',
          'åŒ…è£…è½¦é—´',
          'åŸæ–™ä»“åº“',
          'æˆå“ä»“åº“',
          'è´¨æ£€ä¸­å¿ƒ',
          'æ±¡æ°´å¤„ç†ç«™',
          'é”…ç‚‰æˆ¿',
          'é…ç”µå®¤',
          'åœè½¦åœº'
        ]

        const testTypes = [
          'æ´å‡€å®¤ç¯å¢ƒ',
          'ç”Ÿæ´»é¥®ç”¨æ°´',
          'å·¥ä¸šåºŸæ°´',
          'å™ªéŸ³æ£€æµ‹',
          'ç©ºæ°”è´¨é‡',
          '50325-2020',
          '18883-2022',
          'åœŸå£¤æ£€æµ‹',
          'é£Ÿå“æ¥è§¦ææ–™',
          'åŒ–å­¦å“æ£€æµ‹',
          'å¾®ç”Ÿç‰©æ£€æµ‹',
          'é‡é‡‘å±æ£€æµ‹',
          'æœ‰æœºæ±¡æŸ“ç‰©',
          'æ”¾å°„æ€§æ£€æµ‹',
          'VOCsæ£€æµ‹'
        ]

        const orders = []
        const today = new Date()

        for (let i = 0; i < 30; i++) {
          const isUrgent = Math.random() < 0.3 // 30%çš„è®¢å•æ˜¯åŠ æ€¥çš„
          const submitTime = new Date(today)
          submitTime.setHours(today.getHours() - Math.floor(Math.random() * 72)) // è¿‡å»72å°æ—¶å†…çš„éšæœºæ—¶é—´

          orders.push({
            id: `XW${today.getFullYear()}${String(today.getMonth() + 1).padStart(2, '0')}${String(today.getDate()).padStart(2, '0')}-${String(100 + i).padStart(3, '0')}`,
            customer: customers[Math.floor(Math.random() * customers.length)],
            unit: units[Math.floor(Math.random() * units.length)],
            testType: testTypes[Math.floor(Math.random() * testTypes.length)],
            submitTime: formatDateTime(submitTime),
            isUrgent: isUrgent
          })
        }

        // æŒ‰æäº¤æ—¶é—´å€’åºæ’åºï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
        orders.sort((a, b) => {
          // å…ˆæŒ‰åŠ æ€¥çŠ¶æ€æ’åº
          if (a.isUrgent && !b.isUrgent) return -1
          if (!a.isUrgent && b.isUrgent) return 1
          // å†æŒ‰æ—¶é—´æ’åº
          return new Date(b.submitTime) - new Date(a.submitTime)
        })

        return orders
      }

      // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
      function formatDateTime(date) {
        const year = date.getFullYear()
        const month = String(date.getMonth() + 1).padStart(2, '0')
        const day = String(date.getDate()).padStart(2, '0')
        const hours = String(date.getHours()).padStart(2, '0')
        const minutes = String(date.getMinutes()).padStart(2, '0')
        return `${year}-${month}-${day} ${hours}:${minutes}`
      }

      // åˆ›å»ºè®¢å•å¡ç‰‡HTML
      function createOrderCard(order) {
        return `
                <div class="order-card ${order.isUrgent ? 'urgent' : ''}">
                    <div class="order-header">
                        <div class="order-id" onclick="window.location.href='order-review.html'">${order.id}</div>
                        ${order.isUrgent ? '<span class="urgent-badge">åŠ æ€¥</span>' : ''}
                    </div>
                    <div class="order-info">
                        <div class="info-row">
                            <span class="info-label">å®¢æˆ·åç§°ï¼š</span>
                            <span class="info-value">${order.customer}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">å—æ£€å•ä½ï¼š</span>
                            <span class="info-value">${order.unit}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">æ£€æµ‹ç±»å‹ï¼š</span>
                            <span class="info-value"${order.testType.includes('50325') || order.testType.includes('18883') ? ' style="color: #059669; font-weight: 500;"' : ''}>${order.testType}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">æäº¤æ—¶é—´ï¼š</span>
                            <span class="info-value">${order.submitTime}</span>
                        </div>
                    </div>
                    <div class="order-actions">
                        <button class="btn btn-view" onclick="window.location.href='order-review.html'">æŸ¥çœ‹è¯¦æƒ…</button>
                        <button class="btn btn-approve" onclick="approveOrder('${order.id}')">å¿«é€Ÿé€šè¿‡</button>
                        <button class="btn btn-reject" onclick="rejectOrder('${order.id}')">é©³å›</button>
                    </div>
                </div>
            `
      }

      // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
      function showLoading() {
        document.getElementById('loadingOverlay').classList.add('active')
      }

      // éšè—åŠ è½½åŠ¨ç”»
      function hideLoading() {
        setTimeout(() => {
          document.getElementById('loadingOverlay').classList.remove('active')
        }, 300)
      }

      // æ¸²æŸ“è®¢å•åˆ—è¡¨
      function renderOrders() {
        showLoading()

        const orderGrid = document.getElementById('orderGrid')
        const startIndex = (currentPage - 1) * itemsPerPage
        const endIndex = Math.min(
          startIndex + itemsPerPage,
          filteredOrders.length
        )
        const pageOrders = filteredOrders.slice(startIndex, endIndex)

        // æ¸…ç©ºå¹¶é‡æ–°å¡«å……è®¢å•åˆ—è¡¨
        orderGrid.innerHTML = ''

        if (pageOrders.length === 0) {
          orderGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">ğŸ“‹</div>
                        <div class="empty-title">æš‚æ— å¾…å®¡æ ¸è®¢å•</div>
                        <div class="empty-desc">å½“å‰é¡µé¢æ²¡æœ‰éœ€è¦å®¡æ ¸çš„è®¢å•</div>
                    </div>
                `
        } else {
          pageOrders.forEach(order => {
            orderGrid.innerHTML += createOrderCard(order)
          })
        }

        // æ›´æ–°åˆ†é¡µä¿¡æ¯
        updatePaginationInfo()

        // æ»šåŠ¨åˆ°é¡¶éƒ¨
        window.scrollTo({ top: 0, behavior: 'smooth' })

        hideLoading()
      }

      // æ›´æ–°åˆ†é¡µä¿¡æ¯
      function updatePaginationInfo() {
        const startRecord =
          filteredOrders.length === 0 ? 0 : (currentPage - 1) * itemsPerPage + 1
        const endRecord = Math.min(
          currentPage * itemsPerPage,
          filteredOrders.length
        )

        document.getElementById('startRecord').textContent = startRecord
        document.getElementById('endRecord').textContent = endRecord
        document.getElementById('totalRecords').textContent =
          filteredOrders.length

        // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
        const urgentCount = filteredOrders.filter(o => o.isUrgent).length
        document.querySelector(
          '.stat-card:nth-child(1) .stat-value'
        ).textContent = filteredOrders.length
        document.querySelector(
          '.stat-card:nth-child(2) .stat-value'
        ).textContent = urgentCount

        // æ›´æ–°åˆ†é¡µæŒ‰é’®çŠ¶æ€
        updatePaginationButtons()
      }

      // æ›´æ–°åˆ†é¡µæŒ‰é’®
      function updatePaginationButtons() {
        totalPages = Math.ceil(filteredOrders.length / itemsPerPage) || 1

        // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
        document.getElementById('firstPageBtn').disabled = currentPage === 1
        document.getElementById('prevPageBtn').disabled = currentPage === 1
        document.getElementById('nextPageBtn').disabled =
          currentPage === totalPages
        document.getElementById('lastPageBtn').disabled =
          currentPage === totalPages

        // ç”Ÿæˆé¡µç æŒ‰é’®
        const pageNumbers = document.getElementById('pageNumbers')
        pageNumbers.innerHTML = ''

        // è®¡ç®—æ˜¾ç¤ºçš„é¡µç èŒƒå›´
        let startPage = Math.max(1, currentPage - 2)
        let endPage = Math.min(totalPages, startPage + 4)

        if (endPage - startPage < 4) {
          startPage = Math.max(1, endPage - 4)
        }

        // å¦‚æœä¸æ˜¯ä»ç¬¬ä¸€é¡µå¼€å§‹ï¼Œæ·»åŠ çœç•¥å·
        if (startPage > 1) {
          const dots = document.createElement('span')
          dots.textContent = '...'
          dots.style.padding = '0 8px'
          dots.style.color = '#9ca3af'
          pageNumbers.appendChild(dots)
        }

        // æ·»åŠ é¡µç æŒ‰é’®
        for (let i = startPage; i <= endPage; i++) {
          const btn = document.createElement('button')
          btn.className = 'page-btn'
          btn.textContent = i
          btn.onclick = () => goToPage(i)

          if (i === currentPage) {
            btn.classList.add('active')
          }

          pageNumbers.appendChild(btn)
        }

        // å¦‚æœä¸æ˜¯åˆ°æœ€åä¸€é¡µï¼Œæ·»åŠ çœç•¥å·
        if (endPage < totalPages) {
          const dots = document.createElement('span')
          dots.textContent = '...'
          dots.style.padding = '0 8px'
          dots.style.color = '#9ca3af'
          pageNumbers.appendChild(dots)
        }

        // æ›´æ–°è·³è½¬è¾“å…¥æ¡†çš„æœ€å¤§å€¼
        document.getElementById('pageJumpInput').max = totalPages
      }

      // è·³è½¬åˆ°æŒ‡å®šé¡µ
      function goToPage(page) {
        if (page < 1) page = 1
        if (page > totalPages) page = totalPages

        currentPage = page
        renderOrders()
      }

      // ä¸Šä¸€é¡µ
      function previousPage() {
        if (currentPage > 1) {
          goToPage(currentPage - 1)
        }
      }

      // ä¸‹ä¸€é¡µ
      function nextPage() {
        if (currentPage < totalPages) {
          goToPage(currentPage + 1)
        }
      }

      // è·³è½¬åˆ°è¾“å…¥çš„é¡µç 
      function jumpToPage() {
        const input = document.getElementById('pageJumpInput')
        const page = parseInt(input.value)

        if (!isNaN(page)) {
          goToPage(page)
          input.value = '' // æ¸…ç©ºè¾“å…¥æ¡†
        }
      }

      // æœç´¢è®¢å•
      function searchOrders(keyword) {
        if (!keyword) {
          filteredOrders = [...allOrders]
        } else {
          const lowerKeyword = keyword.toLowerCase()
          filteredOrders = allOrders.filter(
            order =>
              order.id.toLowerCase().includes(lowerKeyword) ||
              order.customer.toLowerCase().includes(lowerKeyword) ||
              order.unit.toLowerCase().includes(lowerKeyword) ||
              order.testType.toLowerCase().includes(lowerKeyword)
          )
        }

        currentPage = 1 // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
        renderOrders()
      }

      // è¿‡æ»¤åŠ æ€¥è®¢å•
      function filterUrgentOrders(urgentOnly) {
        const searchKeyword = document.querySelector('.search-input').value

        if (urgentOnly) {
          filteredOrders = allOrders.filter(order => order.isUrgent)
        } else {
          filteredOrders = [...allOrders]
        }

        // å¦‚æœæœ‰æœç´¢å…³é”®è¯ï¼Œå†æ¬¡è¿‡æ»¤
        if (searchKeyword) {
          searchOrders(searchKeyword)
        } else {
          currentPage = 1
          renderOrders()
        }
      }

      // å¿«é€Ÿé€šè¿‡è®¢å•
      function approveOrder(orderId) {
        if (confirm(`ç¡®å®šè¦é€šè¿‡è®¢å• ${orderId} å—ï¼Ÿ`)) {
          showLoading()

          // æ¨¡æ‹Ÿå®¡æ ¸æ“ä½œ
          setTimeout(() => {
            // ä»åˆ—è¡¨ä¸­ç§»é™¤è¯¥è®¢å•
            const index = allOrders.findIndex(o => o.id === orderId)
            if (index !== -1) {
              allOrders.splice(index, 1)
              filteredOrders = filteredOrders.filter(o => o.id !== orderId)

              // æ›´æ–°ä»Šæ—¥å·²å®¡æ ¸æ•°é‡
              const todayApproved = document.querySelector(
                '.stat-card:nth-child(3) .stat-value'
              )
              todayApproved.textContent =
                parseInt(todayApproved.textContent) + 1

              // å¦‚æœå½“å‰é¡µæ²¡æœ‰æ•°æ®äº†ï¼Œè¿”å›ä¸Šä¸€é¡µ
              const newTotalPages =
                Math.ceil(filteredOrders.length / itemsPerPage) || 1
              if (currentPage > newTotalPages) {
                currentPage = newTotalPages
              }

              renderOrders()
              alert(`è®¢å• ${orderId} å·²é€šè¿‡å®¡æ ¸ï¼`)
            }

            hideLoading()
          }, 500)
        }
      }

      // é©³å›è®¢å•
      function rejectOrder(orderId) {
        const reason = prompt(`è¯·è¾“å…¥é©³å›è®¢å• ${orderId} çš„åŸå› ï¼š`)
        if (reason) {
          showLoading()

          // æ¨¡æ‹Ÿé©³å›æ“ä½œ
          setTimeout(() => {
            // ä»åˆ—è¡¨ä¸­ç§»é™¤è¯¥è®¢å•
            const index = allOrders.findIndex(o => o.id === orderId)
            if (index !== -1) {
              allOrders.splice(index, 1)
              filteredOrders = filteredOrders.filter(o => o.id !== orderId)

              // å¦‚æœå½“å‰é¡µæ²¡æœ‰æ•°æ®äº†ï¼Œè¿”å›ä¸Šä¸€é¡µ
              const newTotalPages =
                Math.ceil(filteredOrders.length / itemsPerPage) || 1
              if (currentPage > newTotalPages) {
                currentPage = newTotalPages
              }

              renderOrders()
              alert(`è®¢å• ${orderId} å·²è¢«é©³å›ï¼\né©³å›åŸå› ï¼š${reason}`)
            }

            hideLoading()
          }, 500)
        }
      }

      // åˆå§‹åŒ–é¡µé¢
      document.addEventListener('DOMContentLoaded', () => {
        // è®¾ç½®é¡µé¢æ ‡é¢˜
        if (window.limsNav) {
          window.limsNav.setPageTitle('è®¢å•å®¡æ ¸å·¥ä½œå°')
        }

        // ç”Ÿæˆæµ‹è¯•æ•°æ®
        allOrders = generateTestOrders()
        filteredOrders = [...allOrders]

        // åˆå§‹æ¸²æŸ“
        renderOrders()

        // ç»‘å®šæœç´¢äº‹ä»¶
        const searchInput = document.querySelector('.search-input')
        searchInput.addEventListener('input', function (e) {
          searchOrders(e.target.value)
        })

        // ç»‘å®šåŠ æ€¥ç­›é€‰äº‹ä»¶
        document
          .getElementById('urgentOnly')
          .addEventListener('change', function (e) {
            filterUrgentOrders(e.target.checked)
          })

        // ç»‘å®šå›è½¦é”®è·³è½¬
        document
          .getElementById('pageJumpInput')
          .addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
              jumpToPage()
            }
          })

        // é»˜è®¤æ˜¾ç¤ºæ‰€æœ‰è®¢å•
        setTimeout(() => {
          document.getElementById('urgentOnly').checked = false
          filterUrgentOrders(false)
        }, 100)
      })
    </script>
  </body>
</html>
