<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>é‡‡æ ·è°ƒåº¦ç®¡ç†ä¸­å¿ƒ - LIMS-XWç³»ç»Ÿ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC',
          'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 1600px;
        margin: 0 auto;
        padding: 24px;
      }

      /* ç»Ÿè®¡ä»ªè¡¨æ¿ */
      .dashboard-header {
        margin-bottom: 32px;
      }

      .page-title {
        font-size: 28px;
        font-weight: 700;
        color: #1a202c;
        margin-bottom: 24px;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .page-title::before {
        content: 'ğŸ“Š';
        font-size: 32px;
      }

      .stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
      }

      .stat-card {
        background: white;
        border-radius: 16px;
        padding: 24px;
        box-shadow:
          0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
      }

      .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--card-color) 0%,
          var(--card-color-light) 100%
        );
      }

      .stat-card.pending {
        --card-color: #f97316;
        --card-color-light: #fb923c;
      }

      .stat-card.assigned {
        --card-color: #3b82f6;
        --card-color-light: #60a5fa;
      }

      .stat-card.urgent {
        --card-color: #ef4444;
        --card-color-light: #f87171;
      }

      .stat-card.today {
        --card-color: #10b981;
        --card-color-light: #34d399;
      }

      .stat-card:hover {
        transform: translateY(-4px);
        box-shadow:
          0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
        border-color: var(--card-color);
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        background: linear-gradient(
          135deg,
          var(--card-color) 0%,
          var(--card-color-light) 100%
        );
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: white;
        margin-bottom: 16px;
      }

      .stat-content {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
      }

      .stat-info {
        flex: 1;
      }

      .stat-value {
        font-size: 36px;
        font-weight: 700;
        color: #1a202c;
        line-height: 1;
        margin-bottom: 8px;
      }

      .stat-label {
        font-size: 14px;
        color: #6b7280;
        font-weight: 500;
      }

      .stat-trend {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 13px;
        color: var(--card-color);
        font-weight: 600;
        margin-top: 8px;
      }

      /* Tabå¯¼èˆª */
      .tabs-container {
        background: white;
        border-radius: 16px;
        box-shadow:
          0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        overflow: hidden;
      }

      .tabs-header {
        display: flex;
        background: #f9fafb;
        border-bottom: 2px solid #e5e7eb;
        position: relative;
      }

      .tab-btn {
        flex: 1;
        padding: 16px 24px;
        background: transparent;
        border: none;
        font-size: 15px;
        font-weight: 600;
        color: #6b7280;
        cursor: pointer;
        transition: all 0.3s;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .tab-btn:hover {
        background: rgba(59, 130, 246, 0.05);
        color: #3b82f6;
      }

      .tab-btn.active {
        color: #1a202c;
        background: white;
      }

      .tab-btn.active::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, #3b82f6 0%, #60a5fa 100%);
      }

      .tab-badge {
        background: #ef4444;
        color: white;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 700;
        min-width: 24px;
        text-align: center;
      }

      .tab-badge.pending {
        background: #f97316;
      }

      .tab-badge.assigned {
        background: #3b82f6;
      }

      /* æœç´¢å’Œç­›é€‰æ  */
      .filter-bar {
        padding: 20px 24px;
        background: #f9fafb;
        border-bottom: 1px solid #e5e7eb;
        display: flex;
        gap: 16px;
        align-items: center;
        flex-wrap: wrap;
      }

      .search-box {
        flex: 1;
        min-width: 300px;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 10px 16px 10px 40px;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        font-size: 14px;
        transition: all 0.3s;
        background: white;
      }

      .search-input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .search-icon {
        position: absolute;
        left: 14px;
        top: 50%;
        transform: translateY(-50%);
        color: #9ca3af;
      }

      .filter-group {
        display: flex;
        gap: 12px;
        align-items: center;
      }

      .filter-select {
        padding: 10px 16px;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        font-size: 14px;
        background: white;
        cursor: pointer;
        transition: all 0.3s;
      }

      .filter-select:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      /* ä»»åŠ¡åˆ—è¡¨ */
      .tab-content {
        display: none;
        padding: 24px;
        min-height: 500px;
      }

      .tab-content.active {
        display: block;
      }

      .task-grid {
        display: grid;
        gap: 16px;
        margin-bottom: 24px;
      }

      .task-card {
        background: white;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        padding: 20px;
        transition: all 0.3s;
        position: relative;
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 20px;
        align-items: center;
      }

      .task-card:hover {
        border-color: #3b82f6;
        box-shadow:
          0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        transform: translateX(4px);
      }

      .task-card.urgent {
        border-left: 4px solid #ef4444;
      }

      .task-main {
        display: grid;
        gap: 12px;
      }

      .task-header {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
      }

      .task-number {
        font-size: 16px;
        font-weight: 700;
        color: #1a202c;
      }

      .task-badges {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .badge {
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
      }

      .badge.urgent {
        background: #fee2e2;
        color: #dc2626;
      }

      .badge.normal {
        background: #dbeafe;
        color: #2563eb;
      }

      .badge.completed {
        background: #d1fae5;
        color: #059669;
      }

      .task-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 12px;
      }

      .info-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #4b5563;
      }

      .info-icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #9ca3af;
      }

      .task-actions {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        white-space: nowrap;
      }

      .btn-primary {
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        color: white;
      }

      .btn-primary:hover {
        background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
        transform: scale(1.02);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      }

      .btn-secondary {
        background: #f3f4f6;
        color: #4b5563;
      }

      .btn-secondary:hover {
        background: #e5e7eb;
      }

      .btn-warning {
        background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
        color: white;
      }

      .btn-warning:hover {
        background: linear-gradient(135deg, #ea580c 0%, #dc2626 100%);
        transform: scale(1.02);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      }

      /* åˆ†é¡µæ§ä»¶ */
      .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin-top: 24px;
      }

      .page-btn {
        padding: 8px 12px;
        border: 2px solid #e5e7eb;
        background: white;
        border-radius: 8px;
        color: #4b5563;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s;
        min-width: 40px;
        text-align: center;
      }

      .page-btn:hover:not(:disabled) {
        border-color: #3b82f6;
        color: #3b82f6;
        background: rgba(59, 130, 246, 0.05);
      }

      .page-btn.active {
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        color: white;
        border-color: #3b82f6;
      }

      .page-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .page-info {
        padding: 0 16px;
        color: #6b7280;
        font-size: 14px;
      }

      /* æ¨¡æ€æ¡† */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(8px);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        animation: fadeIn 0.3s;
      }

      .modal.active {
        display: flex;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .modal-content {
        background: white;
        border-radius: 20px;
        width: 90%;
        max-width: 600px;
        max-height: 90vh;
        overflow: hidden;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes slideUp {
        from {
          transform: translateY(50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-header {
        padding: 24px;
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        color: white;
      }

      .modal-title {
        font-size: 20px;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .modal-subtitle {
        font-size: 14px;
        opacity: 0.9;
        margin-top: 4px;
      }

      .modal-body {
        padding: 24px;
        max-height: 60vh;
        overflow-y: auto;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #374151;
        font-size: 14px;
      }

      .form-control {
        width: 100%;
        padding: 10px 14px;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        font-size: 14px;
        transition: all 0.3s;
      }

      .form-control:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      .staff-select-grid {
        display: grid;
        gap: 12px;
        max-height: 200px;
        overflow-y: auto;
        padding: 12px;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        background: #f9fafb;
      }

      .staff-option {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: white;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .staff-option:hover {
        border-color: #3b82f6;
        background: rgba(59, 130, 246, 0.05);
      }

      .staff-option.selected {
        border-color: #3b82f6;
        background: rgba(59, 130, 246, 0.1);
      }

      .staff-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
      }

      .staff-details {
        flex: 1;
      }

      .staff-name {
        font-weight: 600;
        color: #1a202c;
        margin-bottom: 2px;
      }

      .staff-status {
        font-size: 12px;
        color: #6b7280;
      }

      .staff-workload {
        padding: 4px 8px;
        background: #f3f4f6;
        border-radius: 6px;
        font-size: 12px;
        color: #4b5563;
        font-weight: 600;
      }

      /* å¯¹æ¯”æ˜¾ç¤º */
      .comparison-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        padding: 16px;
        background: #f9fafb;
        border-radius: 10px;
        margin-bottom: 20px;
      }

      .comparison-column {
        padding: 16px;
        background: white;
        border-radius: 8px;
        border: 2px solid #e5e7eb;
      }

      .comparison-column.old {
        border-color: #ef4444;
      }

      .comparison-column.new {
        border-color: #10b981;
      }

      .comparison-title {
        font-weight: 600;
        color: #374151;
        margin-bottom: 12px;
        padding-bottom: 8px;
        border-bottom: 2px solid #e5e7eb;
      }

      .comparison-column.old .comparison-title {
        color: #dc2626;
      }

      .comparison-column.new .comparison-title {
        color: #059669;
      }

      .comparison-item {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        font-size: 14px;
      }

      .comparison-label {
        color: #6b7280;
      }

      .comparison-value {
        font-weight: 600;
        color: #1a202c;
      }

      .modal-footer {
        padding: 20px 24px;
        background: #f9fafb;
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        border-top: 1px solid #e5e7eb;
      }

      /* ç©ºçŠ¶æ€ */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
      }

      .empty-icon {
        font-size: 64px;
        margin-bottom: 16px;
        opacity: 0.5;
      }

      .empty-title {
        font-size: 18px;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
      }

      .empty-message {
        font-size: 14px;
        color: #6b7280;
      }

      /* å“åº”å¼è®¾è®¡ */
      @media (max-width: 768px) {
        .container {
          padding: 16px;
        }

        .stats-container {
          grid-template-columns: 1fr 1fr;
        }

        .filter-bar {
          flex-direction: column;
          align-items: stretch;
        }

        .search-box {
          min-width: auto;
        }

        .task-card {
          grid-template-columns: 1fr;
        }

        .task-info {
          grid-template-columns: 1fr;
        }

        .task-actions {
          flex-direction: row;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .comparison-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 480px) {
        .stats-container {
          grid-template-columns: 1fr;
        }

        .page-title {
          font-size: 24px;
        }

        .tab-btn {
          font-size: 14px;
          padding: 12px 16px;
        }
      }
    </style>
  </head>
  <body>
    <script src="navigation.js"></script>

    <div class="container">
      <!-- é¡µé¢æ ‡é¢˜å’Œç»Ÿè®¡ä»ªè¡¨æ¿ -->
      <div class="dashboard-header">
        <h1 class="page-title">é‡‡æ ·è°ƒåº¦ç®¡ç†ä¸­å¿ƒ</h1>

        <div class="stats-container">
          <div class="stat-card pending">
            <div class="stat-icon">ğŸ“‹</div>
            <div class="stat-content">
              <div class="stat-info">
                <div class="stat-value" id="pendingCount">30</div>
                <div class="stat-label">å¾…åˆ†æ´¾ä»»åŠ¡</div>
                <div class="stat-trend">â†‘ è¾ƒæ˜¨æ—¥å¢åŠ 5ä¸ª</div>
              </div>
            </div>
          </div>

          <div class="stat-card assigned">
            <div class="stat-icon">âœ…</div>
            <div class="stat-content">
              <div class="stat-info">
                <div class="stat-value" id="assignedCount">25</div>
                <div class="stat-label">å·²åˆ†æ´¾ä»»åŠ¡</div>
                <div class="stat-trend">â†’ æ‰§è¡Œç‡ 92%</div>
              </div>
            </div>
          </div>

          <div class="stat-card urgent">
            <div class="stat-icon">âš¡</div>
            <div class="stat-content">
              <div class="stat-info">
                <div class="stat-value" id="urgentCount">8</div>
                <div class="stat-label">åŠ æ€¥ä»»åŠ¡</div>
                <div class="stat-trend">éœ€ç«‹å³å¤„ç†</div>
              </div>
            </div>
          </div>

          <div class="stat-card today">
            <div class="stat-icon">ğŸ“…</div>
            <div class="stat-content">
              <div class="stat-info">
                <div class="stat-value" id="todayCount">12</div>
                <div class="stat-label">ä»Šæ—¥å¾…é‡‡æ ·</div>
                <div class="stat-trend">â†’ å®Œæˆç‡ 75%</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tabåˆ‡æ¢å®¹å™¨ -->
      <div class="tabs-container">
        <div class="tabs-header">
          <button class="tab-btn active" onclick="switchTab('pending')">
            <span>å¾…åˆ†æ´¾ä»»åŠ¡</span>
            <span class="tab-badge pending" id="pendingBadge">30</span>
          </button>
          <button class="tab-btn" onclick="switchTab('assigned')">
            <span>å·²åˆ†æ´¾ä»»åŠ¡</span>
            <span class="tab-badge assigned" id="assignedBadge">25</span>
          </button>
        </div>

        <!-- æœç´¢å’Œç­›é€‰æ  -->
        <div class="filter-bar">
          <div class="search-box">
            <span class="search-icon">ğŸ”</span>
            <input
              type="text"
              class="search-input"
              id="searchInput"
              placeholder="æœç´¢ä»»åŠ¡ç¼–å·ã€å•ä½åç§°æˆ–åœ°å€..."
            />
          </div>
          <div class="filter-group">
            <select class="filter-select" id="priorityFilter">
              <option value="">æ‰€æœ‰ä¼˜å…ˆçº§</option>
              <option value="urgent">ç´§æ€¥</option>
              <option value="normal">æ™®é€š</option>
            </select>
            <select class="filter-select" id="dateFilter">
              <option value="">æ‰€æœ‰æ—¥æœŸ</option>
              <option value="today">ä»Šæ—¥</option>
              <option value="tomorrow">æ˜æ—¥</option>
              <option value="week">æœ¬å‘¨</option>
            </select>
            <button class="btn btn-secondary" onclick="resetFilters()">
              é‡ç½®ç­›é€‰
            </button>
          </div>
        </div>

        <!-- å¾…åˆ†æ´¾ä»»åŠ¡åˆ—è¡¨ -->
        <div class="active tab-content" id="pendingTab">
          <div class="task-grid" id="pendingTaskList">
            <!-- ä»»åŠ¡å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>
          <div class="pagination" id="pendingPagination">
            <!-- åˆ†é¡µæ§ä»¶å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>

        <!-- å·²åˆ†æ´¾ä»»åŠ¡åˆ—è¡¨ -->
        <div class="tab-content" id="assignedTab">
          <div class="task-grid" id="assignedTaskList">
            <!-- ä»»åŠ¡å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>
          <div class="pagination" id="assignedPagination">
            <!-- åˆ†é¡µæ§ä»¶å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>
      </div>
    </div>

    <!-- åˆ†æ´¾ä»»åŠ¡æ¨¡æ€æ¡† -->
    <div class="modal" id="assignModal">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title">
            <span>ğŸ“</span>
            <span>åˆ†æ´¾ä»»åŠ¡</span>
          </div>
          <div class="modal-subtitle">
            ä»»åŠ¡ç¼–å·: <span id="assignTaskNumber"></span>
          </div>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label class="form-label">é‡‡æ ·æ—¥æœŸ</label>
            <input type="date" class="form-control" id="samplingDate" />
          </div>

          <div class="form-group">
            <label class="form-label">é‡‡æ ·æ—¶é—´</label>
            <div class="form-row">
              <input
                type="time"
                class="form-control"
                id="startTime"
                placeholder="å¼€å§‹æ—¶é—´"
              />
              <input
                type="time"
                class="form-control"
                id="endTime"
                placeholder="ç»“æŸæ—¶é—´"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">é€‰æ‹©é‡‡æ ·äººå‘˜ï¼ˆå¯å¤šé€‰ï¼‰</label>
            <div class="staff-select-grid" id="staffSelectGrid">
              <!-- äººå‘˜é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">å¤‡æ³¨è¯´æ˜ï¼ˆé€‰å¡«ï¼‰</label>
            <textarea
              class="form-control"
              id="assignRemark"
              rows="3"
              placeholder="è¯·è¾“å…¥ç‰¹æ®Šè¦æ±‚æˆ–æ³¨æ„äº‹é¡¹..."
            ></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal('assignModal')">
            å–æ¶ˆ
          </button>
          <button class="btn btn-primary" onclick="confirmAssign()">
            ç¡®è®¤åˆ†æ´¾
          </button>
        </div>
      </div>
    </div>

    <!-- é‡æ–°è°ƒæ•´æ¨¡æ€æ¡† -->
    <div class="modal" id="adjustModal">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title">
            <span>ğŸ”„</span>
            <span>é‡æ–°è°ƒæ•´ä»»åŠ¡</span>
          </div>
          <div class="modal-subtitle">
            ä»»åŠ¡ç¼–å·: <span id="adjustTaskNumber"></span>
          </div>
        </div>
        <div class="modal-body">
          <!-- å¯¹æ¯”æ˜¾ç¤ºåŒºåŸŸ -->
          <div class="comparison-grid">
            <div class="comparison-column old">
              <div class="comparison-title">å½“å‰å®‰æ’</div>
              <div class="comparison-item">
                <span class="comparison-label">é‡‡æ ·æ—¥æœŸï¼š</span>
                <span class="comparison-value" id="oldDate">2024-03-15</span>
              </div>
              <div class="comparison-item">
                <span class="comparison-label">é‡‡æ ·æ—¶é—´ï¼š</span>
                <span class="comparison-value" id="oldTime">09:00 - 11:00</span>
              </div>
              <div class="comparison-item">
                <span class="comparison-label">é‡‡æ ·äººå‘˜ï¼š</span>
                <span class="comparison-value" id="oldStaff">æé‡‡æ ·</span>
              </div>
            </div>
            <div class="comparison-column new">
              <div class="comparison-title">æ–°çš„å®‰æ’</div>
              <div class="comparison-item">
                <span class="comparison-label">é‡‡æ ·æ—¥æœŸï¼š</span>
                <span class="comparison-value" id="newDateDisplay">-</span>
              </div>
              <div class="comparison-item">
                <span class="comparison-label">é‡‡æ ·æ—¶é—´ï¼š</span>
                <span class="comparison-value" id="newTimeDisplay">-</span>
              </div>
              <div class="comparison-item">
                <span class="comparison-label">é‡‡æ ·äººå‘˜ï¼š</span>
                <span class="comparison-value" id="newStaffDisplay">-</span>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">æ–°çš„é‡‡æ ·æ—¥æœŸ</label>
            <input
              type="date"
              class="form-control"
              id="adjustDate"
              onchange="updateNewDisplay()"
            />
          </div>

          <div class="form-group">
            <label class="form-label">æ–°çš„é‡‡æ ·æ—¶é—´</label>
            <div class="form-row">
              <input
                type="time"
                class="form-control"
                id="adjustStartTime"
                onchange="updateNewDisplay()"
              />
              <input
                type="time"
                class="form-control"
                id="adjustEndTime"
                onchange="updateNewDisplay()"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">é‡æ–°é€‰æ‹©é‡‡æ ·äººå‘˜</label>
            <div class="staff-select-grid" id="adjustStaffGrid">
              <!-- äººå‘˜é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">è°ƒæ•´åŸå› </label>
            <textarea
              class="form-control"
              id="adjustReason"
              rows="2"
              placeholder="è¯·è¯´æ˜è°ƒæ•´åŸå› ..."
            ></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal('adjustModal')">
            å–æ¶ˆ
          </button>
          <button class="btn btn-warning" onclick="confirmAdjust()">
            ç¡®è®¤è°ƒæ•´
          </button>
        </div>
      </div>
    </div>

    <script>
      // å…¨å±€å˜é‡
      let currentTab = 'pending'
      let currentPendingPage = 1
      let currentAssignedPage = 1
      const itemsPerPage = 10
      let selectedStaff = new Set()
      let selectedAdjustStaff = new Set()

      // æµ‹è¯•æ•°æ®ç”Ÿæˆ
      const pendingTasks = []
      const assignedTasks = []

      // æ£€æµ‹ç±»å‹åˆ—è¡¨
      const testTypes = [
        '50325-2020',
        'GB/T 18883',
        'HJ 583-2010',
        'GB 50325',
        'ISO 16000'
      ]

      // ç”Ÿæˆ30æ¡å¾…åˆ†æ´¾ä»»åŠ¡
      for (let i = 1; i <= 30; i++) {
        pendingTasks.push({
          id: `XW202403${String(i).padStart(3, '0')}`,
          company: [
            'æ·±åœ³å¸‚æŸæŸè‡ªæ¥æ°´å…¬å¸',
            'ç¦ç”°åŒºæŸé…’åº—',
            'ç½—æ¹–åŒºæŸå°åŒºç‰©ä¸š',
            'å—å±±åŒºæŸåŒ»é™¢',
            'å®å®‰åŒºæŸå·¥å‚'
          ][i % 5],
          address: [
            'æ·±åœ³å¸‚å—å±±åŒºç§‘æŠ€å›­å—è·¯123å·',
            'æ·±åœ³å¸‚ç¦ç”°åŒºç¦åè·¯88å·',
            'æ·±åœ³å¸‚ç½—æ¹–åŒºä¸œé—¨åŒ—è·¯456å·',
            'æ·±åœ³å¸‚å—å±±åŒºæ·±å—å¤§é“999å·',
            'æ·±åœ³å¸‚å®å®‰åŒºæ–°å®‰è¡—é“'
          ][i % 5],
          points: Math.floor(Math.random() * 10) + 5,
          testType: testTypes[i % testTypes.length],
          priority: i <= 8 ? 'urgent' : 'normal',
          createTime: `2024-03-${String(15 - Math.floor(i / 10)).padStart(2, '0')} ${String(9 + (i % 12)).padStart(2, '0')}:00`
        })
      }

      // ç”Ÿæˆ25æ¡å·²åˆ†æ´¾ä»»åŠ¡
      for (let i = 1; i <= 25; i++) {
        assignedTasks.push({
          id: `XW202402${String(100 + i).padStart(3, '0')}`,
          company: [
            'é¾™å²—åŒºæŸå•†åœº',
            'åªå±±åŒºæŸå­¦æ ¡',
            'å…‰æ˜åŒºæŸç¤¾åŒº',
            'ç›ç”°åŒºæŸé¤å…',
            'å¤§é¹æ–°åŒºæŸåº¦å‡æ‘'
          ][i % 5],
          address: [
            'æ·±åœ³å¸‚é¾™å²—åŒºé¾™ç¿”å¤§é“1å·',
            'æ·±åœ³å¸‚åªå±±åŒºåªå±±å¤§é“2å·',
            'æ·±åœ³å¸‚å…‰æ˜åŒºå…‰æ˜å¤§è¡—3å·',
            'æ·±åœ³å¸‚ç›ç”°åŒºæµ·å±±è·¯4å·',
            'æ·±åœ³å¸‚å¤§é¹æ–°åŒºè‘µæ¶Œè¡—é“5å·'
          ][i % 5],
          points: Math.floor(Math.random() * 15) + 3,
          duration: Math.floor(Math.random() * 3) + 1 + 'å°æ—¶',
          priority: i <= 3 ? 'urgent' : 'normal',
          assignedDate: `2024-03-${String(15 + Math.floor(i / 5)).padStart(2, '0')}`,
          assignedTime: `${String(8 + (i % 8)).padStart(2, '0')}:00 - ${String(10 + (i % 8)).padStart(2, '0')}:00`,
          assignedStaff: [
            'æé‡‡æ ·',
            'ç‹æŠ€æœ¯',
            'å¼ å·¥ç¨‹',
            'é™ˆä¸“å‘˜',
            'èµµæŠ€æœ¯',
            'åˆ˜é‡‡æ ·'
          ][i % 6],
          status: i <= 12 ? 'today' : 'scheduled'
        })
      }

      // é‡‡æ ·äººå‘˜æ•°æ®
      const staffList = [
        { id: 1, name: 'æé‡‡æ ·', status: 'ç©ºé—²', tasks: 2 },
        { id: 2, name: 'ç‹æŠ€æœ¯', status: 'å·¥ä½œä¸­', tasks: 3 },
        { id: 3, name: 'å¼ å·¥ç¨‹', status: 'ç©ºé—²', tasks: 1 },
        { id: 4, name: 'é™ˆä¸“å‘˜', status: 'ç©ºé—²', tasks: 0 },
        { id: 5, name: 'èµµæŠ€æœ¯', status: 'å·¥ä½œä¸­', tasks: 4 },
        { id: 6, name: 'åˆ˜é‡‡æ ·', status: 'ç©ºé—²', tasks: 2 }
      ]

      // é¡µé¢åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', () => {
        if (window.limsNav) {
          window.limsNav.setPageTitle('é‡‡æ ·è°ƒåº¦ç®¡ç†ä¸­å¿ƒ')
        }

        updateStats()
        renderTasks()
        initializeStaffSelect()

        // è®¾ç½®ä»Šå¤©æ—¥æœŸä¸ºé»˜è®¤å€¼
        const today = new Date().toISOString().split('T')[0]
        document.getElementById('samplingDate').value = today
        document.getElementById('adjustDate').value = today
      })

      // Tabåˆ‡æ¢
      function switchTab(tab) {
        currentTab = tab

        // æ›´æ–°TabæŒ‰é’®çŠ¶æ€
        document.querySelectorAll('.tab-btn').forEach(btn => {
          btn.classList.remove('active')
        })
        event.target.closest('.tab-btn').classList.add('active')

        // æ›´æ–°Tabå†…å®¹æ˜¾ç¤º
        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.remove('active')
        })
        document.getElementById(`${tab}Tab`).classList.add('active')

        renderTasks()
      }

      // æ›´æ–°ç»Ÿè®¡æ•°æ®
      function updateStats() {
        const urgentPending = pendingTasks.filter(
          t => t.priority === 'urgent'
        ).length
        const todayAssigned = assignedTasks.filter(
          t => t.status === 'today'
        ).length

        document.getElementById('pendingCount').textContent =
          pendingTasks.length
        document.getElementById('assignedCount').textContent =
          assignedTasks.length
        document.getElementById('urgentCount').textContent = urgentPending
        document.getElementById('todayCount').textContent = todayAssigned

        document.getElementById('pendingBadge').textContent =
          pendingTasks.length
        document.getElementById('assignedBadge').textContent =
          assignedTasks.length
      }

      // æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
      function renderTasks() {
        if (currentTab === 'pending') {
          renderPendingTasks()
        } else {
          renderAssignedTasks()
        }
      }

      // æ¸²æŸ“å¾…åˆ†æ´¾ä»»åŠ¡
      function renderPendingTasks() {
        const container = document.getElementById('pendingTaskList')
        const startIndex = (currentPendingPage - 1) * itemsPerPage
        const endIndex = startIndex + itemsPerPage
        const tasksToShow = pendingTasks.slice(startIndex, endIndex)

        if (tasksToShow.length === 0) {
          container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“­</div>
                        <div class="empty-title">æš‚æ— å¾…åˆ†æ´¾ä»»åŠ¡</div>
                        <div class="empty-message">æ‰€æœ‰ä»»åŠ¡éƒ½å·²åˆ†æ´¾å®Œæˆ</div>
                    </div>
                `
        } else {
          container.innerHTML = tasksToShow
            .map(
              task => `
                    <div class="task-card ${task.priority === 'urgent' ? 'urgent' : ''}">
                        <div class="task-main">
                            <div class="task-header">
                                <span class="task-number">${task.id}</span>
                                <div class="task-badges">
                                    <span class="badge ${task.priority}">${task.priority === 'urgent' ? 'ç´§æ€¥' : 'æ™®é€š'}</span>
                                </div>
                            </div>
                            <div class="task-info">
                                <div class="info-item">
                                    <span class="info-icon">ğŸ¢</span>
                                    <span>${task.company}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ“</span>
                                    <span>${task.address}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ“Š</span>
                                    <span>${task.points}ä¸ªé‡‡æ ·ç‚¹</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ§ª</span>
                                    <span><span style="background: #10b981; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;">${task.testType}</span></span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ“…</span>
                                    <span>åˆ›å»ºæ—¶é—´: ${task.createTime}</span>
                                </div>
                            </div>
                        </div>
                        <div class="task-actions">
                            <button class="btn btn-secondary" onclick="viewTaskDetail('${task.id}')">æŸ¥çœ‹è¯¦æƒ…</button>
                            <button class="btn btn-primary" onclick="openAssignModal('${task.id}')">ç«‹å³åˆ†æ´¾</button>
                        </div>
                    </div>
                `
            )
            .join('')
        }

        renderPagination('pending', pendingTasks.length)
      }

      // æ¸²æŸ“å·²åˆ†æ´¾ä»»åŠ¡
      function renderAssignedTasks() {
        const container = document.getElementById('assignedTaskList')
        const startIndex = (currentAssignedPage - 1) * itemsPerPage
        const endIndex = startIndex + itemsPerPage
        const tasksToShow = assignedTasks.slice(startIndex, endIndex)

        if (tasksToShow.length === 0) {
          container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“­</div>
                        <div class="empty-title">æš‚æ— å·²åˆ†æ´¾ä»»åŠ¡</div>
                        <div class="empty-message">è¯·å…ˆåˆ†æ´¾å¾…å¤„ç†çš„ä»»åŠ¡</div>
                    </div>
                `
        } else {
          container.innerHTML = tasksToShow
            .map(
              task => `
                    <div class="task-card">
                        <div class="task-main">
                            <div class="task-header">
                                <span class="task-number">${task.id}</span>
                                <div class="task-badges">
                                    <span class="badge ${task.priority}">${task.priority === 'urgent' ? 'ç´§æ€¥' : 'æ™®é€š'}</span>
                                    ${task.status === 'today' ? '<span class="badge completed">ä»Šæ—¥ä»»åŠ¡</span>' : ''}
                                </div>
                            </div>
                            <div class="task-info">
                                <div class="info-item">
                                    <span class="info-icon">ğŸ¢</span>
                                    <span>${task.company}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ“</span>
                                    <span>${task.address}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ‘¤</span>
                                    <span>é‡‡æ ·å‘˜: ${task.assignedStaff}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ“…</span>
                                    <span>${task.assignedDate}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">â°</span>
                                    <span>${task.assignedTime}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-icon">ğŸ“Š</span>
                                    <span>${task.points}ä¸ªé‡‡æ ·ç‚¹</span>
                                </div>
                            </div>
                        </div>
                        <div class="task-actions">
                            <button class="btn btn-warning" onclick="openAdjustModal('${task.id}')">é‡æ–°è°ƒæ•´</button>
                            <button class="btn btn-secondary" onclick="viewTaskDetail('${task.id}')">æŸ¥çœ‹è¯¦æƒ…</button>
                        </div>
                    </div>
                `
            )
            .join('')
        }

        renderPagination('assigned', assignedTasks.length)
      }

      // æ¸²æŸ“åˆ†é¡µæ§ä»¶
      function renderPagination(type, totalItems) {
        const totalPages = Math.ceil(totalItems / itemsPerPage)
        const currentPage =
          type === 'pending' ? currentPendingPage : currentAssignedPage
        const container = document.getElementById(`${type}Pagination`)

        if (totalPages <= 1) {
          container.innerHTML = ''
          return
        }

        let html = ''

        // ä¸Šä¸€é¡µæŒ‰é’®
        html += `<button class="page-btn" onclick="changePage('${type}', ${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>ä¸Šä¸€é¡µ</button>`

        // é¡µç æŒ‰é’®
        for (let i = 1; i <= totalPages; i++) {
          if (
            i === 1 ||
            i === totalPages ||
            (i >= currentPage - 2 && i <= currentPage + 2)
          ) {
            html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage('${type}', ${i})">${i}</button>`
          } else if (i === currentPage - 3 || i === currentPage + 3) {
            html += `<span class="page-info">...</span>`
          }
        }

        // ä¸‹ä¸€é¡µæŒ‰é’®
        html += `<button class="page-btn" onclick="changePage('${type}', ${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>ä¸‹ä¸€é¡µ</button>`

        // é¡µé¢ä¿¡æ¯
        html += `<span class="page-info">å…± ${totalPages} é¡µï¼Œ${totalItems} æ¡è®°å½•</span>`

        container.innerHTML = html
      }

      // åˆ‡æ¢é¡µé¢
      function changePage(type, page) {
        if (type === 'pending') {
          currentPendingPage = page
        } else {
          currentAssignedPage = page
        }
        renderTasks()
      }

      // åˆå§‹åŒ–äººå‘˜é€‰æ‹©
      function initializeStaffSelect() {
        const assignGrid = document.getElementById('staffSelectGrid')
        const adjustGrid = document.getElementById('adjustStaffGrid')

        const staffHTML = staffList
          .map(
            staff => `
                <div class="staff-option" onclick="toggleStaff(${staff.id}, '${staff.name}')">
                    <div class="staff-avatar">${staff.name[0]}</div>
                    <div class="staff-details">
                        <div class="staff-name">${staff.name}</div>
                        <div class="staff-status">çŠ¶æ€: ${staff.status}</div>
                    </div>
                    <div class="staff-workload">ä»Šæ—¥${staff.tasks}ä¸ªä»»åŠ¡</div>
                </div>
            `
          )
          .join('')

        assignGrid.innerHTML = staffHTML
        adjustGrid.innerHTML = staffHTML.replace(
          /toggleStaff/g,
          'toggleAdjustStaff'
        )
      }

      // åˆ‡æ¢äººå‘˜é€‰æ‹©
      function toggleStaff(id, name) {
        const element = event.currentTarget
        if (selectedStaff.has(id)) {
          selectedStaff.delete(id)
          element.classList.remove('selected')
        } else {
          selectedStaff.add(id)
          element.classList.add('selected')
        }
      }

      function toggleAdjustStaff(id, name) {
        const element = event.currentTarget

        // æ¸…é™¤å…¶ä»–é€‰æ‹©ï¼ˆå•é€‰ï¼‰
        document
          .querySelectorAll('#adjustStaffGrid .staff-option')
          .forEach(opt => {
            opt.classList.remove('selected')
          })
        selectedAdjustStaff.clear()

        selectedAdjustStaff.add(name)
        element.classList.add('selected')
        updateNewDisplay()
      }

      // æ‰“å¼€åˆ†æ´¾æ¨¡æ€æ¡†
      function openAssignModal(taskId) {
        document.getElementById('assignTaskNumber').textContent = taskId
        document.getElementById('assignModal').classList.add('active')
        selectedStaff.clear()
        document
          .querySelectorAll('#staffSelectGrid .staff-option')
          .forEach(opt => {
            opt.classList.remove('selected')
          })
      }

      // æ‰“å¼€è°ƒæ•´æ¨¡æ€æ¡†
      function openAdjustModal(taskId) {
        const task = assignedTasks.find(t => t.id === taskId)
        if (task) {
          document.getElementById('adjustTaskNumber').textContent = taskId
          document.getElementById('oldDate').textContent = task.assignedDate
          document.getElementById('oldTime').textContent = task.assignedTime
          document.getElementById('oldStaff').textContent = task.assignedStaff

          // é‡ç½®æ–°çš„æ˜¾ç¤º
          document.getElementById('newDateDisplay').textContent = '-'
          document.getElementById('newTimeDisplay').textContent = '-'
          document.getElementById('newStaffDisplay').textContent = '-'

          document.getElementById('adjustModal').classList.add('active')
          selectedAdjustStaff.clear()
          document
            .querySelectorAll('#adjustStaffGrid .staff-option')
            .forEach(opt => {
              opt.classList.remove('selected')
            })
        }
      }

      // æ›´æ–°æ–°çš„æ˜¾ç¤º
      function updateNewDisplay() {
        const date = document.getElementById('adjustDate').value
        const startTime = document.getElementById('adjustStartTime').value
        const endTime = document.getElementById('adjustEndTime').value
        const staff = Array.from(selectedAdjustStaff).join(', ')

        document.getElementById('newDateDisplay').textContent = date || '-'
        document.getElementById('newTimeDisplay').textContent =
          startTime && endTime ? `${startTime} - ${endTime}` : '-'
        document.getElementById('newStaffDisplay').textContent = staff || '-'
      }

      // å…³é—­æ¨¡æ€æ¡†
      function closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active')
      }

      // ç¡®è®¤åˆ†æ´¾
      function confirmAssign() {
        const date = document.getElementById('samplingDate').value
        const startTime = document.getElementById('startTime').value
        const endTime = document.getElementById('endTime').value

        if (!date || !startTime || !endTime) {
          alert('è¯·å¡«å†™å®Œæ•´çš„æ—¶é—´ä¿¡æ¯')
          return
        }

        if (selectedStaff.size === 0) {
          alert('è¯·è‡³å°‘é€‰æ‹©ä¸€åé‡‡æ ·äººå‘˜')
          return
        }

        alert('åˆ†æ´¾æˆåŠŸï¼ä»»åŠ¡å·²æ·»åŠ åˆ°å·²åˆ†æ´¾åˆ—è¡¨ã€‚')
        closeModal('assignModal')

        // æ¨¡æ‹Ÿæ›´æ–°æ•°æ®
        const taskId = document.getElementById('assignTaskNumber').textContent
        const taskIndex = pendingTasks.findIndex(t => t.id === taskId)
        if (taskIndex !== -1) {
          const task = pendingTasks.splice(taskIndex, 1)[0]
          assignedTasks.unshift({
            ...task,
            assignedDate: date,
            assignedTime: `${startTime} - ${endTime}`,
            assignedStaff: Array.from(selectedStaff)
              .map(id => staffList.find(s => s.id === parseInt(id))?.name)
              .join(', '),
            status: 'scheduled'
          })
          updateStats()
          renderTasks()
        }
      }

      // ç¡®è®¤è°ƒæ•´
      function confirmAdjust() {
        const reason = document.getElementById('adjustReason').value

        if (!reason.trim()) {
          alert('è¯·è¯´æ˜è°ƒæ•´åŸå› ')
          return
        }

        alert('è°ƒæ•´æˆåŠŸï¼ä»»åŠ¡å®‰æ’å·²æ›´æ–°ã€‚')
        closeModal('adjustModal')
      }

      // æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…
      function viewTaskDetail(taskId) {
        // è·³è½¬åˆ°è¯¦æƒ…é¡µé¢ï¼Œä¼ é€’ä»»åŠ¡IDå‚æ•°
        window.location.href = `sampling-dispatch-detail.html?taskId=${taskId}`
      }

      // æœç´¢åŠŸèƒ½
      document.getElementById('searchInput').addEventListener('input', e => {
        const query = e.target.value.toLowerCase()
        // å®é™…åº”ç”¨ä¸­åº”è¯¥è¿‡æ»¤ä»»åŠ¡åˆ—è¡¨
        console.log('æœç´¢:', query)
      })

      // é‡ç½®ç­›é€‰
      function resetFilters() {
        document.getElementById('searchInput').value = ''
        document.getElementById('priorityFilter').value = ''
        document.getElementById('dateFilter').value = ''
        renderTasks()
      }

      // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', e => {
          if (e.target === modal) {
            modal.classList.remove('active')
          }
        })
      })

      // ESCé”®å…³é—­æ¨¡æ€æ¡†
      document.addEventListener('keydown', e => {
        if (e.key === 'Escape') {
          document.querySelectorAll('.modal.active').forEach(modal => {
            modal.classList.remove('active')
          })
        }
      })
    </script>
  </body>
</html>
